{
    "workflow": {
      "unique_name": "definition_workflow_01VHGK34JQZ6R3oyuGQeLVFrr99ezVGpNHM",
      "name": "CHRIVAND-Incident-Correlator-Twitter-Module",
      "title": "CHRIVAND-Incident-Correlator-Twitter-Module",
      "type": "generic.workflow",
      "base_type": "workflow",
      "variables": [
        {
          "schema_id": "datatype.string",
          "properties": {
            "value": "",
            "scope": "local",
            "name": "Threat Response Environment URL",
            "type": "datatype.string",
            "description": "Placeholder for the URL of the Threat Response environment being used. You don't need to provide this, it will be fetched automatically",
            "is_required": false,
            "is_invisible": false
          },
          "unique_name": "variable_workflow_01VHGK34Q6L0U5vhjql7BIlwKutEvh93xSP",
          "object_type": "variable_workflow"
        },
        {
          "schema_id": "datatype.date",
          "properties": {
            "value": "0001-01-01T00:00:00+00:00",
            "scope": "local",
            "name": "Threat Response Token Time",
            "type": "datatype.date",
            "description": "The time at which the Threat Response access token was last fetched. This is used to determine when it's time to fetch a new token and should not be modified",
            "is_required": false,
            "is_invisible": false
          },
          "unique_name": "variable_workflow_01VHGK34Q8M6L1GyaWk6uiqBrIRm9fCVflA",
          "object_type": "variable_workflow"
        },
        {
          "schema_id": "datatype.secure_string",
          "properties": {
            "value": "",
            "scope": "local",
            "name": "Threat Response Access Token",
            "type": "datatype.secure_string",
            "description": "Placeholder for the Threat Response access token. This token will be fetched as needed throughout the workflow and this variable should not be modified",
            "is_required": false,
            "is_invisible": false
          },
          "unique_name": "variable_workflow_01VHGK34Q700O4jJHNJ5U8mW1DzWfcnRZO4",
          "object_type": "variable_workflow"
        },
        {
          "schema_id": "datatype.string",
          "properties": {
            "value": "[]",
            "scope": "local",
            "name": "Targets",
            "type": "datatype.string",
            "description": "Placeholder for a list of targets from your Threat Response module sightings. This will be populated automatically",
            "is_required": false,
            "is_invisible": false
          },
          "unique_name": "variable_workflow_01VHGK34Q7DTZ6sSvNDC9YRNeZNJ7eJMwwK",
          "object_type": "variable_workflow"
        },
        {
          "schema_id": "datatype.secure_string",
          "properties": {
            "value": "*****",
            "scope": "local",
            "name": "Twitter API Key",
            "type": "datatype.secure_string",
            "is_required": false,
            "is_invisible": false
          },
          "unique_name": "variable_workflow_01VHGXVTQW6801b96mFFyh2P0KUP4HTuhLt",
          "object_type": "variable_workflow"
        },
        {
          "schema_id": "datatype.secure_string",
          "properties": {
            "value": "*****",
            "scope": "local",
            "name": "Webex Teams Access Token",
            "type": "datatype.secure_string",
            "description": "The access token to use to authenticate to the Webex Teams API. Information about using a bot, which is what we recommend, can be found here: https://developer.webex.com/docs/bots",
            "is_required": false,
            "is_invisible": false
          },
          "unique_name": "variable_workflow_01VHGK34Q778K2zIthFSvCMlRPVe57TR02v",
          "object_type": "variable_workflow"
        },
        {
          "schema_id": "datatype.string",
          "properties": {
            "value": "[]",
            "scope": "local",
            "name": "Sightings",
            "type": "datatype.string",
            "description": "Placeholder for a list of sightings from your Threat Response modules. This will be populated automatically",
            "is_required": false,
            "is_invisible": false
          },
          "unique_name": "variable_workflow_01VHGK34Q865F5EgDDFNMCSVTJzrshTmhau",
          "object_type": "variable_workflow"
        },
        {
          "schema_id": "datatype.string",
          "properties": {
            "value": "[]",
            "scope": "local",
            "name": "Non-Clean Observables",
            "type": "datatype.string",
            "description": "A JSON-formatted list of observables that have a disposition of unknown, suspicious, or malicious",
            "is_required": false,
            "is_invisible": false
          },
          "unique_name": "variable_workflow_01VHGK34Q7LA146O3rM9Ig5lFM27h42uFlL",
          "object_type": "variable_workflow"
        },
        {
          "schema_id": "datatype.integer",
          "properties": {
            "value": 0,
            "scope": "local",
            "name": "Number of Non-Clean Observables",
            "type": "datatype.integer",
            "description": "How many non-clean observables were found during the investigation (as in: unknown, suspicious, or malicious)",
            "is_required": false,
            "is_invisible": false
          },
          "unique_name": "variable_workflow_01VHGK34Q8EMX27hinnZDbgn8JuOze4tC7W",
          "object_type": "variable_workflow"
        }
      ],
      "properties": {
        "atomic": {
          "is_atomic": false
        },
        "delete_workflow_instance": false,
        "description": "This workflow takes a #OPENDIR Tweet, conducts an investigation into it using Cisco Threat Response, and then puts the results in a SecureX incident and sends a Webex notification.\n\nTarget Group: Default TargetGroup\n\nTargets Used: CTR_For_Access_Token, CTR_API, Private_CTIA_Target, Webex Teams\n\nSteps:\n[] Fetch recent tweets with Global var since_id\n[] Request a Threat Response access token and inspect the blog post content for observables\n[] Loop through each observable and get its Threat Response disposition\n[] For observables that weren't clean, conduct Threat Response enrichment to get sightings\n[] For modules with sightings, build the text to post to Webex\n[] Create the SecureX casebook and, if a teams room is provided, post a message to Webex\n\nMore information: https://ciscosecurity.github.io/sxo-05-security-workflows/workflows/0002",
        "display_name": "CHRIVAND-Incident-Correlator-Twitter-Module",
        "runtime_user": {
          "override_target_runtime_user": false,
          "specify_on_workflow_start": false,
          "target_default": true
        },
        "target": {
          "execute_on_target_group": true,
          "target_group": {
            "target_group_id": "target_group_01EJ0TQWPQWBD0qiWqClJKj9FOzwiZRfOFH",
            "run_on_all_targets": false,
            "selected_target_types": [
              "web-service.endpoint"
            ],
            "use_criteria": {
              "choose_target_using_algorithm": "choose_first_with_matching_criteria",
              "conditions": [
                {
                  "operator": "eqi",
                  "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                  "right_operand": "CTR_API"
                }
              ]
            }
          }
        }
      },
      "object_type": "definition_workflow",
      "actions": [
        {
          "unique_name": "definition_activity_01VHGU4TBUHNA6tBHiRfY7JBwSAtEmaWS5u",
          "name": "Group",
          "title": "RETRIEVE IOCS FROM TWITTER",
          "type": "logic.group",
          "base_type": "activity",
          "properties": {
            "continue_on_failure": false,
            "display_name": "RETRIEVE IOCS FROM TWITTER",
            "skip_execution": false
          },
          "object_type": "definition_activity",
          "actions": [
            {
              "unique_name": "definition_activity_01VHGUDVBSAW27fDOX4G6qJBFYGxgKU9SWm",
              "name": "HTTP Request",
              "title": "Twitter Search API",
              "type": "web-service.http_request",
              "base_type": "activity",
              "properties": {
                "accept": "application/json",
                "action_timeout": 180,
                "allow_auto_redirect": true,
                "content_type": "application/json",
                "continue_on_error_status_code": false,
                "continue_on_failure": true,
                "custom_headers": [
                  {
                    "name": "Authorization",
                    "value": "Bearer $workflow.definition_workflow_01VHGK34JQZ6R3oyuGQeLVFrr99ezVGpNHM.local.variable_workflow_01VHGXVTQW6801b96mFFyh2P0KUP4HTuhLt$"
                  }
                ],
                "display_name": "Twitter Search API",
                "method": "GET",
                "relative_url": "tweets/search/recent?query=%23opendir&max_results=100&since_id=$global.variable_01VHHLD64C3I65TJbsXR4ePJ1ZxyArK2XOa.global.variable_01VHHLD64C3I65TJbsXR4ePJ1ZxyArK2XOa$",
                "runtime_user": {
                  "target_default": true
                },
                "skip_execution": false,
                "target": {
                  "override_workflow_target": true,
                  "target_id": "definition_target_01VHGXEUKA38Q01MTwjOxz5Ea9HvrlDDqWQ"
                }
              },
              "object_type": "definition_activity"
            },
            {
              "unique_name": "definition_activity_01VHHMFWZVYMG50f83b5jpsZAu2xkmgAZJJ",
              "name": "Condition Block",
              "title": "Error checking",
              "type": "logic.if_else",
              "base_type": "activity",
              "properties": {
                "continue_on_failure": false,
                "display_name": "Error checking",
                "skip_execution": false
              },
              "object_type": "definition_activity",
              "blocks": [
                {
                  "unique_name": "definition_activity_01VHHMFXEFXNR21VZeNKafTFg7bCOraVWr6",
                  "name": "Condition Branch",
                  "title": "NOT 200",
                  "type": "logic.condition_block",
                  "base_type": "activity",
                  "properties": {
                    "condition": {
                      "left_operand": "$activity.definition_activity_01VHGUDVBSAW27fDOX4G6qJBFYGxgKU9SWm.output.status_code$",
                      "operator": "ne",
                      "right_operand": 200
                    },
                    "continue_on_failure": false,
                    "display_name": "NOT 200",
                    "skip_execution": false
                  },
                  "object_type": "definition_activity",
                  "actions": [
                    {
                      "unique_name": "definition_activity_01VHHMZKSIP7J5tqfxCjbMoMrF03iXRU4Th",
                      "name": "Completed",
                      "title": "Failed",
                      "type": "logic.completed",
                      "base_type": "activity",
                      "properties": {
                        "completion_type": "failed-completed",
                        "continue_on_failure": false,
                        "display_name": "Failed",
                        "result_message": "Status code: $activity.definition_activity_01VHGUDVBSAW27fDOX4G6qJBFYGxgKU9SWm.output.status_code$",
                        "skip_execution": false
                      },
                      "object_type": "definition_activity"
                    }
                  ]
                }
              ]
            },
            {
              "unique_name": "definition_activity_01VHK1RX9EY9V0XLTSBFPSyxZqhZ6dhVtt1",
              "name": "Condition Block",
              "title": "Tweets returned?",
              "type": "logic.if_else",
              "base_type": "activity",
              "properties": {
                "continue_on_failure": false,
                "display_name": "Tweets returned?",
                "skip_execution": false
              },
              "object_type": "definition_activity",
              "blocks": [
                {
                  "unique_name": "definition_activity_01VHK1RXNI0WZ4v676QTT3z0HKK9jEyyq6A",
                  "name": "Condition Branch",
                  "title": "No tweets",
                  "type": "logic.condition_block",
                  "base_type": "activity",
                  "properties": {
                    "condition": {
                      "left_operand": "$activity.definition_activity_01VHGUDVBSAW27fDOX4G6qJBFYGxgKU9SWm.output.response_body$",
                      "operator": "eq",
                      "right_operand": "{\n  \"meta\": {\n    \"result_count\": 0\n  }\n}"
                    },
                    "continue_on_failure": false,
                    "display_name": "No tweets",
                    "skip_execution": false
                  },
                  "object_type": "definition_activity",
                  "actions": [
                    {
                      "unique_name": "definition_activity_01VHK3503SQOW1XXx2SfIiWSzrmA980PcAx",
                      "name": "Completed",
                      "title": "Go back to sleep",
                      "type": "logic.completed",
                      "base_type": "activity",
                      "properties": {
                        "completion_type": "succeeded",
                        "continue_on_failure": false,
                        "display_name": "Go back to sleep",
                        "result_message": "No tweets",
                        "skip_execution": false
                      },
                      "object_type": "definition_activity"
                    }
                  ]
                }
              ]
            },
            {
              "unique_name": "definition_activity_01VHISORM9NZA0oH1H41glzZ1ptmhSAq4Dr",
              "name": "JSONPath Query",
              "title": "parse out since_id",
              "type": "corejava.jsonpathquery",
              "base_type": "activity",
              "properties": {
                "action_timeout": 180,
                "continue_on_failure": true,
                "display_name": "parse out since_id",
                "input_json": "$activity.definition_activity_01VHGUDVBSAW27fDOX4G6qJBFYGxgKU9SWm.output.response_body$",
                "jsonpath_queries": [
                  {
                    "jsonpath_query": "$.meta.newest_id",
                    "jsonpath_query_name": "since_id",
                    "jsonpath_query_type": "string"
                  }
                ],
                "skip_execution": false
              },
              "object_type": "definition_activity"
            },
            {
              "unique_name": "definition_activity_01VHIUY04EPHE5QbjrolutmQgjwl16a5lyB",
              "name": "Set Variables",
              "title": "Set global var since_id",
              "type": "core.set_multiple_variables",
              "base_type": "activity",
              "properties": {
                "continue_on_failure": false,
                "display_name": "Set global var since_id",
                "skip_execution": false,
                "variables_to_update": [
                  {
                    "variable_to_update": "$global.variable_01VHHLD64C3I65TJbsXR4ePJ1ZxyArK2XOa.global.variable_01VHHLD64C3I65TJbsXR4ePJ1ZxyArK2XOa$",
                    "variable_value_new": "$activity.definition_activity_01VHISORM9NZA0oH1H41glzZ1ptmhSAq4Dr.output.jsonpath_queries.since_id$"
                  }
                ]
              },
              "object_type": "definition_activity"
            },
            {
              "unique_name": "definition_activity_01VHJ6Y90VDXL1nXXj12e2FG3UbFhz1lFrB",
              "name": "Read Table from JSON",
              "title": "Add tweets to table from json",
              "type": "corejava.read_table_from_json",
              "base_type": "activity",
              "properties": {
                "action_timeout": 180,
                "continue_on_failure": false,
                "display_name": "Add tweets to table from json",
                "input_json": "$activity.definition_activity_01VHGUDVBSAW27fDOX4G6qJBFYGxgKU9SWm.output.response_body$",
                "jsonpath_query": "$.data",
                "persist_output": true,
                "populate_columns": false,
                "skip_execution": false,
                "table_columns": [
                  {
                    "column_name": "text",
                    "column_type": "string"
                  },
                  {
                    "column_name": "id",
                    "column_type": "string"
                  }
                ]
              },
              "object_type": "definition_activity"
            }
          ]
        },
        {
          "unique_name": "definition_activity_01VHGK3DZKPMW2J10Oix6pLOgVLYsZBPXWi",
          "name": "Condition Block",
          "title": "Set the environment URL",
          "type": "logic.if_else",
          "base_type": "activity",
          "properties": {
            "continue_on_failure": false,
            "display_name": "Set the environment URL",
            "skip_execution": false
          },
          "object_type": "definition_activity",
          "blocks": [
            {
              "unique_name": "definition_activity_01VHGK3EXZ4W85dJexGzNzPZNuPNORHN2jC",
              "name": "Condition Branch",
              "title": "PROD-NAM",
              "type": "logic.condition_block",
              "base_type": "activity",
              "properties": {
                "condition": {
                  "left_operand": "$env.variable_01A6C871LSO9A26D0zcBjJoAKgRglrC10aG.env.variable_01A6C871LSO9A26D0zcBjJoAKgRglrC10aG$",
                  "operator": "eqi",
                  "right_operand": "prod-nam"
                },
                "continue_on_failure": false,
                "display_name": "PROD-NAM",
                "skip_execution": false
              },
              "object_type": "definition_activity",
              "actions": [
                {
                  "unique_name": "definition_activity_01VHGK3G4QLEU4IhXTioAbNYhrLGKUZbMoz",
                  "name": "Set Variables",
                  "title": "Set local environment variables",
                  "type": "core.set_multiple_variables",
                  "base_type": "activity",
                  "properties": {
                    "continue_on_failure": false,
                    "display_name": "Set local environment variables",
                    "skip_execution": false,
                    "variables_to_update": [
                      {
                        "variable_to_update": "$workflow.definition_workflow_01VHGK34JQZ6R3oyuGQeLVFrr99ezVGpNHM.local.variable_workflow_01VHGK34Q6L0U5vhjql7BIlwKutEvh93xSP$",
                        "variable_value_new": "visibility.amp.cisco.com"
                      }
                    ]
                  },
                  "object_type": "definition_activity"
                }
              ]
            },
            {
              "unique_name": "definition_activity_01VHGK3H411EH5kU5Ie6Il10IPWiK946N2U",
              "name": "Condition Branch",
              "title": "PROD-EU",
              "type": "logic.condition_block",
              "base_type": "activity",
              "properties": {
                "condition": {
                  "left_operand": "$env.variable_01A6C871LSO9A26D0zcBjJoAKgRglrC10aG.env.variable_01A6C871LSO9A26D0zcBjJoAKgRglrC10aG$",
                  "operator": "eqi",
                  "right_operand": "prod-eu"
                },
                "continue_on_failure": false,
                "display_name": "PROD-EU",
                "skip_execution": false
              },
              "object_type": "definition_activity",
              "actions": [
                {
                  "unique_name": "definition_activity_01VHGK3I6JKUY1c24zJKuwV2h7zVjQvuzN7",
                  "name": "Set Variables",
                  "title": "Set local environment variables",
                  "type": "core.set_multiple_variables",
                  "base_type": "activity",
                  "properties": {
                    "continue_on_failure": false,
                    "display_name": "Set local environment variables",
                    "skip_execution": false,
                    "variables_to_update": [
                      {
                        "variable_to_update": "$workflow.definition_workflow_01VHGK34JQZ6R3oyuGQeLVFrr99ezVGpNHM.local.variable_workflow_01VHGK34Q6L0U5vhjql7BIlwKutEvh93xSP$",
                        "variable_value_new": "visibility.eu.amp.cisco.com"
                      }
                    ]
                  },
                  "object_type": "definition_activity"
                }
              ]
            },
            {
              "unique_name": "definition_activity_01VHGK3J7XBN94nUtp46NXOJzVjAPCZdJU5",
              "name": "Condition Branch",
              "title": "PROD-APJC",
              "type": "logic.condition_block",
              "base_type": "activity",
              "properties": {
                "condition": {
                  "left_operand": "$env.variable_01A6C871LSO9A26D0zcBjJoAKgRglrC10aG.env.variable_01A6C871LSO9A26D0zcBjJoAKgRglrC10aG$",
                  "operator": "eqi",
                  "right_operand": "prod-apjc"
                },
                "continue_on_failure": false,
                "display_name": "PROD-APJC",
                "skip_execution": false
              },
              "object_type": "definition_activity",
              "actions": [
                {
                  "unique_name": "definition_activity_01VHGK3K9H7890Z5YBX7qqPsjqQcGjZCHC6",
                  "name": "Set Variables",
                  "title": "Set local environment variables",
                  "type": "core.set_multiple_variables",
                  "base_type": "activity",
                  "properties": {
                    "continue_on_failure": false,
                    "display_name": "Set local environment variables",
                    "skip_execution": false,
                    "variables_to_update": [
                      {
                        "variable_to_update": "$workflow.definition_workflow_01VHGK34JQZ6R3oyuGQeLVFrr99ezVGpNHM.local.variable_workflow_01VHGK34Q6L0U5vhjql7BIlwKutEvh93xSP$",
                        "variable_value_new": "visibility.apjc.amp.cisco.com"
                      }
                    ]
                  },
                  "object_type": "definition_activity"
                }
              ]
            }
          ]
        },
        {
          "unique_name": "definition_activity_01VHJBEHLLHW73CWLGKIia6BBeZYGgQP8xi",
          "name": "For Each",
          "title": "For Each Tweet",
          "type": "logic.for_each",
          "base_type": "activity",
          "properties": {
            "continue_on_failure": false,
            "display_name": "For Each Tweet",
            "skip_execution": false,
            "source_array": "$activity.definition_activity_01VHJ6Y90VDXL1nXXj12e2FG3UbFhz1lFrB.output.read_table_from_json$"
          },
          "object_type": "definition_activity",
          "actions": [
            {
              "unique_name": "definition_activity_01VHGK3Q73GRK6GtXLRsjLPNZKeuctLOrQt",
              "name": "Group",
              "title": "Inspect the tweet  content",
              "type": "logic.group",
              "base_type": "activity",
              "properties": {
                "continue_on_failure": false,
                "display_name": "Inspect the tweet  content",
                "skip_execution": false
              },
              "object_type": "definition_activity",
              "actions": [
                {
                  "unique_name": "definition_activity_01VHGK3RZO91Y7W9VWtyZB0y0S9mwjMvdUS",
                  "name": "Threat Response - Generate Access Token",
                  "title": "Threat Response - Generate Access Token",
                  "type": "workflow.atomic_workflow",
                  "base_type": "subworkflow",
                  "properties": {
                    "continue_on_failure": false,
                    "display_name": "Threat Response - Generate Access Token",
                    "runtime_user": {
                      "target_default": true
                    },
                    "skip_execution": false,
                    "target": {
                      "override_workflow_target_group_criteria": true,
                      "target_group": {
                        "run_on_all_targets": false,
                        "use_criteria": {
                          "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                          "conditions": [
                            {
                              "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                              "operator": "eqi",
                              "right_operand": "CTR_For_Access_Token"
                            }
                          ]
                        }
                      }
                    },
                    "workflow_id": "definition_workflow_01PP75S3LTBW4420OZU3rdHWKHFnE6aC7yH"
                  },
                  "object_type": "definition_activity"
                },
                {
                  "unique_name": "definition_activity_01VHGK3TISH4K6dZCxapqPzeZzQv4o32kAI",
                  "name": "Set Variables",
                  "title": "Set local token variables",
                  "type": "core.set_multiple_variables",
                  "base_type": "activity",
                  "properties": {
                    "continue_on_failure": false,
                    "display_name": "Set local token variables",
                    "skip_execution": false,
                    "variables_to_update": [
                      {
                        "variable_to_update": "$workflow.definition_workflow_01VHGK34JQZ6R3oyuGQeLVFrr99ezVGpNHM.local.variable_workflow_01VHGK34Q700O4jJHNJ5U8mW1DzWfcnRZO4$",
                        "variable_value_new": "$activity.definition_activity_01VHGK3RZO91Y7W9VWtyZB0y0S9mwjMvdUS.output.variable_workflow_01PP75S3G7CJY6WAQr2IJC7qga2SIoE09gQ$"
                      },
                      {
                        "variable_to_update": "$workflow.definition_workflow_01VHGK34JQZ6R3oyuGQeLVFrr99ezVGpNHM.local.variable_workflow_01VHGK34Q8M6L1GyaWk6uiqBrIRm9fCVflA$",
                        "variable_value_new": "$activity.definition_activity_01VHGK3RZO91Y7W9VWtyZB0y0S9mwjMvdUS.output.start_time$"
                      }
                    ]
                  },
                  "object_type": "definition_activity"
                },
                {
                  "unique_name": "definition_activity_01VHGK3VFWF207GnBuQ5G4iwgzMfwy0TEIV",
                  "name": "Threat Response - Inspect for Observables",
                  "title": "Threat Response - Inspect for Observables",
                  "type": "workflow.atomic_workflow",
                  "base_type": "subworkflow",
                  "properties": {
                    "continue_on_failure": false,
                    "display_name": "Threat Response - Inspect for Observables",
                    "input": {
                      "variable_workflow_01PP7586F8ITB1sT6OpDzEF79wnWVOJk1N5": "$workflow.definition_workflow_01VHGK34JQZ6R3oyuGQeLVFrr99ezVGpNHM.local.variable_workflow_01VHGK34Q700O4jJHNJ5U8mW1DzWfcnRZO4$",
                      "variable_workflow_01PP7586F8MQB2tFYbNgQC7xGbC7ZoXrOxR": "$activity.definition_activity_01VHJBEHLLHW73CWLGKIia6BBeZYGgQP8xi.input.source_array[@].text$"
                    },
                    "runtime_user": {
                      "target_default": true
                    },
                    "skip_execution": false,
                    "target": {
                      "use_workflow_target_group": true
                    },
                    "workflow_id": "definition_workflow_01PP7586MYQ913P0nWshTHMU7mQNNFG58Bv"
                  },
                  "object_type": "definition_activity"
                },
                {
                  "unique_name": "definition_activity_01VHGK3WISBPJ0fxPDh4LXZMCRuSW8YuaFS",
                  "name": "JSONPath Query",
                  "title": "Test for results",
                  "type": "corejava.jsonpathquery",
                  "base_type": "activity",
                  "properties": {
                    "action_timeout": 180,
                    "continue_on_failure": true,
                    "display_name": "Test for results",
                    "input_json": "$activity.definition_activity_01VHGK3VFWF207GnBuQ5G4iwgzMfwy0TEIV.output.variable_workflow_01PP7586F8O067JBDnBPz8ZD5XctKNSenEX$",
                    "jsonpath_queries": [
                      {
                        "jsonpath_query": "$.[0].value",
                        "jsonpath_query_name": "inspectTest",
                        "jsonpath_query_type": "string"
                      }
                    ],
                    "skip_execution": false
                  },
                  "object_type": "definition_activity"
                },
                {
                  "unique_name": "definition_activity_01VHGK3XKDAEK4XhDhJhISxITLd6iTOZKb9",
                  "name": "Condition Block",
                  "title": "Were there any observables?",
                  "type": "logic.if_else",
                  "base_type": "activity",
                  "properties": {
                    "continue_on_failure": false,
                    "display_name": "Were there any observables?",
                    "skip_execution": false
                  },
                  "object_type": "definition_activity",
                  "blocks": [
                    {
                      "unique_name": "definition_activity_01VHGK3YMDVJU1fhtWQ3zBAxaJwNT8LV2l0",
                      "name": "Condition Branch",
                      "title": "No",
                      "type": "logic.condition_block",
                      "base_type": "activity",
                      "properties": {
                        "condition": {
                          "left_operand": "$activity.definition_activity_01VHGK3WISBPJ0fxPDh4LXZMCRuSW8YuaFS.output.succeeded$",
                          "operator": "eq",
                          "right_operand": false
                        },
                        "continue_on_failure": false,
                        "display_name": "No",
                        "skip_execution": false
                      },
                      "object_type": "definition_activity",
                      "actions": [
                        {
                          "unique_name": "definition_activity_01VJ3219XVPRN3DYldgGG4YiuEMxbov7Zs6",
                          "name": "Continue",
                          "title": "Skip tweet",
                          "type": "logic.continue",
                          "base_type": "activity",
                          "properties": {
                            "continue_on_failure": false,
                            "display_name": "Skip tweet",
                            "skip_execution": false
                          },
                          "object_type": "definition_activity"
                        }
                      ]
                    }
                  ]
                },
                {
                  "unique_name": "definition_activity_01VHGK40LDAA70YdzxcAqBdmiVs0vDxef2p",
                  "name": "Read Table from JSON",
                  "title": "Convert list of observables to table",
                  "type": "corejava.read_table_from_json",
                  "base_type": "activity",
                  "properties": {
                    "action_timeout": 180,
                    "continue_on_failure": false,
                    "display_name": "Convert list of observables to table",
                    "input_json": "$activity.definition_activity_01VHGK3VFWF207GnBuQ5G4iwgzMfwy0TEIV.output.variable_workflow_01PP7586F8O067JBDnBPz8ZD5XctKNSenEX$",
                    "jsonpath_query": "$.*",
                    "persist_output": true,
                    "populate_columns": false,
                    "skip_execution": false,
                    "table_columns": [
                      {
                        "column_name": "type",
                        "column_type": "string"
                      },
                      {
                        "column_name": "value",
                        "column_type": "string"
                      },
                      {
                        "column_name": "disposition",
                        "column_type": "string"
                      }
                    ]
                  },
                  "object_type": "definition_activity"
                }
              ]
            },
            {
              "unique_name": "definition_activity_01VHGK41US8NN3sluNx8hyt1BNJ5Ky0sXSu",
              "name": "Group",
              "title": "Deliberate the observables",
              "type": "logic.group",
              "base_type": "activity",
              "properties": {
                "continue_on_failure": false,
                "display_name": "Deliberate the observables",
                "skip_execution": false
              },
              "object_type": "definition_activity",
              "actions": [
                {
                  "unique_name": "definition_activity_01VHGK439V05H1r6mJXYBSc63VbU0zp3qOO",
                  "name": "For Each",
                  "title": "For each observable",
                  "type": "logic.for_each",
                  "base_type": "activity",
                  "properties": {
                    "continue_on_failure": false,
                    "display_name": "For each observable",
                    "skip_execution": false,
                    "source_array": "$activity.definition_activity_01VHGK40LDAA70YdzxcAqBdmiVs0vDxef2p.output.read_table_from_json$"
                  },
                  "object_type": "definition_activity",
                  "actions": [
                    {
                      "unique_name": "definition_activity_01VHGK45AVDV41KYbrbONRIgxSYBgot8dHL",
                      "name": "Threat Response - Deliberate Observable",
                      "title": "Threat Response - Deliberate Observable",
                      "type": "workflow.atomic_workflow",
                      "base_type": "subworkflow",
                      "properties": {
                        "continue_on_failure": false,
                        "display_name": "Threat Response - Deliberate Observable",
                        "input": {
                          "variable_workflow_01PP77MLJ2S465LuOvU8mlP8mbbcgy9uTXN": "$activity.definition_activity_01VHGK439V05H1r6mJXYBSc63VbU0zp3qOO.input.source_array[@].type$",
                          "variable_workflow_01PP77MLJ2XIE1H3D67PjcsCuGBsKCCBxLI": "$workflow.definition_workflow_01VHGK34JQZ6R3oyuGQeLVFrr99ezVGpNHM.local.variable_workflow_01VHGK34Q700O4jJHNJ5U8mW1DzWfcnRZO4$",
                          "variable_workflow_01PP77MLJ2ZVU1C4VxEfKYh2tlFk9iTx69p": "$activity.definition_activity_01VHGK439V05H1r6mJXYBSc63VbU0zp3qOO.input.source_array[@].value$"
                        },
                        "runtime_user": {
                          "target_default": true
                        },
                        "skip_execution": false,
                        "target": {
                          "use_workflow_target_group": true
                        },
                        "workflow_id": "definition_workflow_01PP77MLQ4QAG765OwlT0ZDqBzv80HvYuPC"
                      },
                      "object_type": "definition_activity"
                    },
                    {
                      "unique_name": "definition_activity_01VHGK46LMPCS71EIWrciCo1FuXadjuWUGG",
                      "name": "Group",
                      "title": "Validate Threat Response token",
                      "type": "logic.group",
                      "base_type": "activity",
                      "properties": {
                        "continue_on_failure": false,
                        "display_name": "Validate Threat Response token",
                        "skip_execution": false
                      },
                      "object_type": "definition_activity",
                      "actions": [
                        {
                          "unique_name": "definition_activity_01VHGK47V22CP1n6enTaq1ecpWbzis7DSAl",
                          "name": "Calculate Date Time Difference",
                          "title": "Check token age",
                          "type": "core.calculate_date_time_difference",
                          "base_type": "activity",
                          "properties": {
                            "continue_on_failure": false,
                            "display_name": "Check token age",
                            "original_date": "$activity.definition_activity_01VHGK45AVDV41KYbrbONRIgxSYBgot8dHL.output.end_time$",
                            "skip_execution": false,
                            "subtract_date": "$workflow.definition_workflow_01VHGK34JQZ6R3oyuGQeLVFrr99ezVGpNHM.local.variable_workflow_01VHGK34Q8M6L1GyaWk6uiqBrIRm9fCVflA$"
                          },
                          "object_type": "definition_activity"
                        },
                        {
                          "unique_name": "definition_activity_01VHGK49050GK5TaPPk2zQ08yK7JQMxnaV2",
                          "name": "Condition Block",
                          "title": "Is it over 8 minutes?",
                          "type": "logic.if_else",
                          "base_type": "activity",
                          "properties": {
                            "continue_on_failure": false,
                            "display_name": "Is it over 8 minutes?",
                            "skip_execution": false
                          },
                          "object_type": "definition_activity",
                          "blocks": [
                            {
                              "unique_name": "definition_activity_01VHGK4A5IQC84XmhRJ4xFZ4oaSFzsP4ySc",
                              "name": "Condition Branch",
                              "title": "Yes",
                              "type": "logic.condition_block",
                              "base_type": "activity",
                              "properties": {
                                "condition": {
                                  "left_operand": "$activity.definition_activity_01VHGK47V22CP1n6enTaq1ecpWbzis7DSAl.output.total_minutes$",
                                  "operator": "gte",
                                  "right_operand": 8
                                },
                                "continue_on_failure": false,
                                "display_name": "Yes",
                                "skip_execution": false
                              },
                              "object_type": "definition_activity",
                              "actions": [
                                {
                                  "unique_name": "definition_activity_01VHGK4BTHS9G1ESTVctpvO1CnMNuXL9Fg5",
                                  "name": "Threat Response - Generate Access Token",
                                  "title": "Threat Response - Generate Access Token",
                                  "type": "workflow.atomic_workflow",
                                  "base_type": "subworkflow",
                                  "properties": {
                                    "continue_on_failure": false,
                                    "display_name": "Threat Response - Generate Access Token",
                                    "runtime_user": {
                                      "target_default": true
                                    },
                                    "skip_execution": false,
                                    "target": {
                                      "override_workflow_target_group_criteria": true,
                                      "target_group": {
                                        "run_on_all_targets": false,
                                        "use_criteria": {
                                          "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                                          "conditions": [
                                            {
                                              "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                                              "operator": "eqi",
                                              "right_operand": "CTR_For_Access_Token"
                                            }
                                          ]
                                        }
                                      }
                                    },
                                    "workflow_id": "definition_workflow_01PP75S3LTBW4420OZU3rdHWKHFnE6aC7yH"
                                  },
                                  "object_type": "definition_activity"
                                },
                                {
                                  "unique_name": "definition_activity_01VHGK4D36CKZ2UMuJiilYcIAM5nSWR72Ie",
                                  "name": "Set Variables",
                                  "title": "Set local token variables",
                                  "type": "core.set_multiple_variables",
                                  "base_type": "activity",
                                  "properties": {
                                    "continue_on_failure": false,
                                    "display_name": "Set local token variables",
                                    "skip_execution": false,
                                    "variables_to_update": [
                                      {
                                        "variable_to_update": "$workflow.definition_workflow_01VHGK34JQZ6R3oyuGQeLVFrr99ezVGpNHM.local.variable_workflow_01VHGK34Q700O4jJHNJ5U8mW1DzWfcnRZO4$",
                                        "variable_value_new": "$activity.definition_activity_01VHGK4BTHS9G1ESTVctpvO1CnMNuXL9Fg5.output.variable_workflow_01PP75S3G7CJY6WAQr2IJC7qga2SIoE09gQ$"
                                      },
                                      {
                                        "variable_to_update": "$workflow.definition_workflow_01VHGK34JQZ6R3oyuGQeLVFrr99ezVGpNHM.local.variable_workflow_01VHGK34Q8M6L1GyaWk6uiqBrIRm9fCVflA$",
                                        "variable_value_new": "$activity.definition_activity_01VHGK4BTHS9G1ESTVctpvO1CnMNuXL9Fg5.output.start_time$"
                                      }
                                    ]
                                  },
                                  "object_type": "definition_activity"
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "unique_name": "definition_activity_01VHGK4EV15HZ2cL1QtnKVwk5ApybKWerki",
                      "name": "Update Row in Table",
                      "title": "Update observable table with disposition",
                      "type": "core.updaterowintable",
                      "base_type": "activity",
                      "properties": {
                        "action_timeout": 180,
                        "columns": [
                          {
                            "column_name": "disposition",
                            "column_type": "string"
                          }
                        ],
                        "continue_on_failure": false,
                        "display_name": "Update observable table with disposition",
                        "input_table": "$activity.definition_activity_01VHGK40LDAA70YdzxcAqBdmiVs0vDxef2p.output.read_table_from_json$",
                        "row": [
                          {
                            "key": "disposition",
                            "type": "string",
                            "value": "$activity.definition_activity_01VHGK45AVDV41KYbrbONRIgxSYBgot8dHL.output.variable_workflow_01PP77MLJ2W9N3jUUa3J6gIRy7Dydhs937R$"
                          }
                        ],
                        "rows": {
                          "rows_matching_criteria": true,
                          "where_clause": "type == '$activity.definition_activity_01VHGK439V05H1r6mJXYBSc63VbU0zp3qOO.input.source_array[@].type$' AND value == '$activity.definition_activity_01VHGK439V05H1r6mJXYBSc63VbU0zp3qOO.input.source_array[@].value$'"
                        },
                        "skip_execution": false
                      },
                      "object_type": "definition_activity"
                    },
                    {
                      "unique_name": "definition_activity_01VHGK4G4D5RX1HpOwvZA8b794ITt4ViJbG",
                      "name": "Condition Block",
                      "title": "Was this observable clean?",
                      "type": "logic.if_else",
                      "base_type": "activity",
                      "properties": {
                        "continue_on_failure": false,
                        "display_name": "Was this observable clean?",
                        "skip_execution": false
                      },
                      "object_type": "definition_activity",
                      "blocks": [
                        {
                          "unique_name": "definition_activity_01VHGK4H7AGYR4rUeWCJM3YgzK8eiSjSXcq",
                          "name": "Condition Branch",
                          "title": "No",
                          "type": "logic.condition_block",
                          "base_type": "activity",
                          "properties": {
                            "condition": {
                              "left_operand": "$activity.definition_activity_01VHGK45AVDV41KYbrbONRIgxSYBgot8dHL.output.variable_workflow_01PP77MLJ2W9N3jUUa3J6gIRy7Dydhs937R$",
                              "operator": "ne",
                              "right_operand": "Clean"
                            },
                            "continue_on_failure": false,
                            "display_name": "No",
                            "skip_execution": false
                          },
                          "object_type": "definition_activity",
                          "actions": [
                            {
                              "unique_name": "definition_activity_01VHGK4IDVY546CovCKxArv8iueiEgvRaCl",
                              "name": "Execute Python Script",
                              "title": "Append this observable to our observable JSON",
                              "type": "python3.script",
                              "base_type": "activity",
                              "properties": {
                                "action_timeout": 180,
                                "continue_on_failure": false,
                                "display_name": "Append this observable to our observable JSON",
                                "script": "import sys,json\n\n# Parse the existing list of observables\nexisting = json.loads(sys.argv[1])\n\n# Get the new observable information\nnewType = sys.argv[2]\nnewValue = sys.argv[3]\n\n# Append the new observable to the list\nexisting.append( { \"type\": newType, \"value\": newValue } )\n\n# Build the new JSON\nnewJson = json.dumps(existing)",
                                "script_arguments": [
                                  "$workflow.definition_workflow_01VHGK34JQZ6R3oyuGQeLVFrr99ezVGpNHM.local.variable_workflow_01VHGK34Q7LA146O3rM9Ig5lFM27h42uFlL$",
                                  "$activity.definition_activity_01VHGK439V05H1r6mJXYBSc63VbU0zp3qOO.input.source_array[@].type$",
                                  "$activity.definition_activity_01VHGK439V05H1r6mJXYBSc63VbU0zp3qOO.input.source_array[@].value$"
                                ],
                                "script_queries": [
                                  {
                                    "script_query": "newJson",
                                    "script_query_name": "newJson",
                                    "script_query_type": "string"
                                  }
                                ],
                                "skip_execution": false
                              },
                              "object_type": "definition_activity"
                            },
                            {
                              "unique_name": "definition_activity_01VHGK4JMZ75W2Xy0kId4eBiflwNlMuH58i",
                              "name": "Set Variables",
                              "title": "Update observable local variables",
                              "type": "core.set_multiple_variables",
                              "base_type": "activity",
                              "properties": {
                                "continue_on_failure": false,
                                "display_name": "Update observable local variables",
                                "skip_execution": false,
                                "variables_to_update": [
                                  {
                                    "variable_to_update": "$workflow.definition_workflow_01VHGK34JQZ6R3oyuGQeLVFrr99ezVGpNHM.local.variable_workflow_01VHGK34Q7LA146O3rM9Ig5lFM27h42uFlL$",
                                    "variable_value_new": "$activity.definition_activity_01VHGK4IDVY546CovCKxArv8iueiEgvRaCl.output.script_queries.newJson$"
                                  },
                                  {
                                    "variable_to_update": "$workflow.definition_workflow_01VHGK34JQZ6R3oyuGQeLVFrr99ezVGpNHM.local.variable_workflow_01VHGK34Q8EMX27hinnZDbgn8JuOze4tC7W$",
                                    "variable_value_new": "$workflow.definition_workflow_01VHGK34JQZ6R3oyuGQeLVFrr99ezVGpNHM.local.variable_workflow_01VHGK34Q8EMX27hinnZDbgn8JuOze4tC7W$+1"
                                  }
                                ]
                              },
                              "object_type": "definition_activity"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "unique_name": "definition_activity_01VHGK4KPZ7K77A22GRA4fKOR4g3GObqzfj",
                  "name": "Condition Block",
                  "title": "Were all of the observables clean?",
                  "type": "logic.if_else",
                  "base_type": "activity",
                  "properties": {
                    "continue_on_failure": false,
                    "display_name": "Were all of the observables clean?",
                    "skip_execution": false
                  },
                  "object_type": "definition_activity",
                  "blocks": [
                    {
                      "unique_name": "definition_activity_01VHGK4LRC2R01fyUxYZpJPrvamPLqcKRtR",
                      "name": "Condition Branch",
                      "title": "Yes",
                      "type": "logic.condition_block",
                      "base_type": "activity",
                      "properties": {
                        "condition": {
                          "left_operand": "$workflow.definition_workflow_01VHGK34JQZ6R3oyuGQeLVFrr99ezVGpNHM.local.variable_workflow_01VHGK34Q8EMX27hinnZDbgn8JuOze4tC7W$",
                          "operator": "eq",
                          "right_operand": 0
                        },
                        "continue_on_failure": false,
                        "display_name": "Yes",
                        "skip_execution": false
                      },
                      "object_type": "definition_activity",
                      "actions": [
                        {
                          "unique_name": "definition_activity_01VHJUEPQ5CLS46AkfFiAMIV7ynikSf0wW4",
                          "name": "Continue",
                          "title": "No non clean observables, skip tweet",
                          "type": "logic.continue",
                          "base_type": "activity",
                          "properties": {
                            "continue_on_failure": false,
                            "display_name": "No non clean observables, skip tweet",
                            "skip_execution": false
                          },
                          "object_type": "definition_activity"
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "unique_name": "definition_activity_01VHGK4NRJ16T72dbF5fFbCCDuEbhKIWgMB",
              "name": "Group",
              "title": "Enrich the observables",
              "type": "logic.group",
              "base_type": "activity",
              "properties": {
                "continue_on_failure": false,
                "display_name": "Enrich the observables",
                "skip_execution": false
              },
              "object_type": "definition_activity",
              "actions": [
                {
                  "unique_name": "definition_activity_01VHGK4P3EN5Y5svpbcpYipGoQ7GcHxGpfa",
                  "name": "For Each",
                  "title": "For each observable",
                  "type": "logic.for_each",
                  "base_type": "activity",
                  "properties": {
                    "continue_on_failure": false,
                    "display_name": "For each observable",
                    "skip_execution": false,
                    "source_array": "$activity.definition_activity_01VHGK40LDAA70YdzxcAqBdmiVs0vDxef2p.output.read_table_from_json$"
                  },
                  "object_type": "definition_activity",
                  "actions": [
                    {
                      "unique_name": "definition_activity_01VHGK4QIG7753AkLdFrwFijfib5Mb4W6Bw",
                      "name": "Condition Block",
                      "title": "Is this observable clean?",
                      "type": "logic.if_else",
                      "base_type": "activity",
                      "properties": {
                        "continue_on_failure": false,
                        "display_name": "Is this observable clean?",
                        "skip_execution": false
                      },
                      "object_type": "definition_activity",
                      "blocks": [
                        {
                          "unique_name": "definition_activity_01VHGK4RIBYHD4BEnQSzxBVZwTwDfGir5lp",
                          "name": "Condition Branch",
                          "title": "Yes",
                          "type": "logic.condition_block",
                          "base_type": "activity",
                          "properties": {
                            "condition": {
                              "left_operand": "$activity.definition_activity_01VHGK4P3EN5Y5svpbcpYipGoQ7GcHxGpfa.input.source_array[@].disposition$",
                              "operator": "eqi",
                              "right_operand": "Clean"
                            },
                            "continue_on_failure": false,
                            "display_name": "Yes",
                            "skip_execution": false
                          },
                          "object_type": "definition_activity",
                          "actions": [
                            {
                              "unique_name": "definition_activity_01VHGK4SXLGPH7fYCori2C9eBZm71LEd0R3",
                              "name": "Continue",
                              "title": "Skip this observable",
                              "type": "logic.continue",
                              "base_type": "activity",
                              "properties": {
                                "continue_on_failure": false,
                                "display_name": "Skip this observable",
                                "skip_execution": false
                              },
                              "object_type": "definition_activity"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "unique_name": "definition_activity_01VHGK4TXCTHT3lCxI1MUpBqU5cJPTsY0lY",
                      "name": "Group",
                      "title": "Validate Threat Response token",
                      "type": "logic.group",
                      "base_type": "activity",
                      "properties": {
                        "continue_on_failure": false,
                        "display_name": "Validate Threat Response token",
                        "skip_execution": false
                      },
                      "object_type": "definition_activity",
                      "actions": [
                        {
                          "unique_name": "definition_activity_01VHGK4V85I1O3LdOz00vsZKHwbrg23NMe9",
                          "name": "Calculate Date Time Difference",
                          "title": "Check token age",
                          "type": "core.calculate_date_time_difference",
                          "base_type": "activity",
                          "properties": {
                            "continue_on_failure": false,
                            "display_name": "Check token age",
                            "original_date": "$activity.definition_activity_01VHGK4QIG7753AkLdFrwFijfib5Mb4W6Bw.output.end_time$",
                            "skip_execution": false,
                            "subtract_date": "$workflow.definition_workflow_01VHGK34JQZ6R3oyuGQeLVFrr99ezVGpNHM.local.variable_workflow_01VHGK34Q8M6L1GyaWk6uiqBrIRm9fCVflA$"
                          },
                          "object_type": "definition_activity"
                        },
                        {
                          "unique_name": "definition_activity_01VHGK4WC0F5875S1Kq3L8plfa3vvohnQyO",
                          "name": "Condition Block",
                          "title": "Is it over 8 minutes?",
                          "type": "logic.if_else",
                          "base_type": "activity",
                          "properties": {
                            "continue_on_failure": false,
                            "display_name": "Is it over 8 minutes?",
                            "skip_execution": false
                          },
                          "object_type": "definition_activity",
                          "blocks": [
                            {
                              "unique_name": "definition_activity_01VHGK4XDA3LO6KsJaHZV8ArAvF6hOjUOHy",
                              "name": "Condition Branch",
                              "title": "Yes",
                              "type": "logic.condition_block",
                              "base_type": "activity",
                              "properties": {
                                "condition": {
                                  "left_operand": "$activity.definition_activity_01VHGK4V85I1O3LdOz00vsZKHwbrg23NMe9.output.total_minutes$",
                                  "operator": "gte",
                                  "right_operand": 8
                                },
                                "continue_on_failure": false,
                                "display_name": "Yes",
                                "skip_execution": false
                              },
                              "object_type": "definition_activity",
                              "actions": [
                                {
                                  "unique_name": "definition_activity_01VHGK4Z5IHHX1UBgrIvYPxpAkIhSrwFXJa",
                                  "name": "Threat Response - Generate Access Token",
                                  "title": "Threat Response - Generate Access Token",
                                  "type": "workflow.atomic_workflow",
                                  "base_type": "subworkflow",
                                  "properties": {
                                    "continue_on_failure": false,
                                    "display_name": "Threat Response - Generate Access Token",
                                    "runtime_user": {
                                      "target_default": true
                                    },
                                    "skip_execution": false,
                                    "target": {
                                      "override_workflow_target_group_criteria": true,
                                      "target_group": {
                                        "run_on_all_targets": false,
                                        "use_criteria": {
                                          "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                                          "conditions": [
                                            {
                                              "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                                              "operator": "eqi",
                                              "right_operand": "CTR_For_Access_Token"
                                            }
                                          ]
                                        }
                                      }
                                    },
                                    "workflow_id": "definition_workflow_01PP75S3LTBW4420OZU3rdHWKHFnE6aC7yH"
                                  },
                                  "object_type": "definition_activity"
                                },
                                {
                                  "unique_name": "definition_activity_01VHGK50KMDX31VSStMOnBhAedKUi6c3QVf",
                                  "name": "Set Variables",
                                  "title": "Set local token variables",
                                  "type": "core.set_multiple_variables",
                                  "base_type": "activity",
                                  "properties": {
                                    "continue_on_failure": false,
                                    "display_name": "Set local token variables",
                                    "skip_execution": false,
                                    "variables_to_update": [
                                      {
                                        "variable_to_update": "$workflow.definition_workflow_01VHGK34JQZ6R3oyuGQeLVFrr99ezVGpNHM.local.variable_workflow_01VHGK34Q700O4jJHNJ5U8mW1DzWfcnRZO4$",
                                        "variable_value_new": "$activity.definition_activity_01VHGK4Z5IHHX1UBgrIvYPxpAkIhSrwFXJa.output.variable_workflow_01PP75S3G7CJY6WAQr2IJC7qga2SIoE09gQ$"
                                      },
                                      {
                                        "variable_to_update": "$workflow.definition_workflow_01VHGK34JQZ6R3oyuGQeLVFrr99ezVGpNHM.local.variable_workflow_01VHGK34Q8M6L1GyaWk6uiqBrIRm9fCVflA$",
                                        "variable_value_new": "$activity.definition_activity_01VHGK4Z5IHHX1UBgrIvYPxpAkIhSrwFXJa.output.start_time$"
                                      }
                                    ]
                                  },
                                  "object_type": "definition_activity"
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "unique_name": "definition_activity_01VHGK531UJVB2fwZfte8WFyBK3eQVMBTPC",
                      "name": "Threat Response - Enrich Observable",
                      "title": "Threat Response - Enrich Observable",
                      "type": "workflow.atomic_workflow",
                      "base_type": "subworkflow",
                      "properties": {
                        "continue_on_failure": false,
                        "display_name": "Threat Response - Enrich Observable",
                        "input": {
                          "variable_workflow_01PP78TYDTQ2L5AWh7XpLPkXldkBYssq6SC": "$activity.definition_activity_01VHGK4P3EN5Y5svpbcpYipGoQ7GcHxGpfa.input.source_array[@].value$",
                          "variable_workflow_01PP78TYDTTUQ6Qtv47uK5sgOFSbJ4b4Cno": "$activity.definition_activity_01VHGK4P3EN5Y5svpbcpYipGoQ7GcHxGpfa.input.source_array[@].type$",
                          "variable_workflow_01PP78TYDTV5R5JK6DtYaS5E95bWbZBstS5": "$workflow.definition_workflow_01VHGK34JQZ6R3oyuGQeLVFrr99ezVGpNHM.local.variable_workflow_01VHGK34Q700O4jJHNJ5U8mW1DzWfcnRZO4$"
                        },
                        "runtime_user": {
                          "target_default": true
                        },
                        "skip_execution": false,
                        "target": {
                          "use_workflow_target_group": true
                        },
                        "workflow_id": "definition_workflow_01PP78TYLE76D6188QkWvzWydNU6L8PtlvS"
                      },
                      "object_type": "definition_activity"
                    },
                    {
                      "unique_name": "definition_activity_01VHGK54ZX6L50UG1hIdhj7ccbdwhrkDeSd",
                      "name": "Read Table from JSON",
                      "title": "Convert list of enrichments to table",
                      "type": "corejava.read_table_from_json",
                      "base_type": "activity",
                      "properties": {
                        "action_timeout": 180,
                        "continue_on_failure": true,
                        "display_name": "Convert list of enrichments to table",
                        "input_json": "$activity.definition_activity_01VHGK531UJVB2fwZfte8WFyBK3eQVMBTPC.output.variable_workflow_01PP78TYDTWG01QGHDq5uwDKdvEqS9CdcYg$",
                        "jsonpath_query": "$.data[*]",
                        "persist_output": false,
                        "populate_columns": false,
                        "skip_execution": false,
                        "table_columns": [
                          {
                            "column_name": "module",
                            "column_type": "string"
                          },
                          {
                            "column_name": "module_type",
                            "column_type": "string"
                          },
                          {
                            "column_name": "data",
                            "column_type": "string"
                          }
                        ]
                      },
                      "object_type": "definition_activity"
                    },
                    {
                      "unique_name": "definition_activity_01VHGK56H6PM53bYTQ7zSoLwQez40UWrFmq",
                      "name": "Condition Block",
                      "title": "Were there any enrichment results?",
                      "type": "logic.if_else",
                      "base_type": "activity",
                      "properties": {
                        "continue_on_failure": false,
                        "display_name": "Were there any enrichment results?",
                        "skip_execution": false
                      },
                      "object_type": "definition_activity",
                      "blocks": [
                        {
                          "unique_name": "definition_activity_01VHGK57KBZBF1KkIFevqDdcvcSCj0SeY3U",
                          "name": "Condition Branch",
                          "title": "No",
                          "type": "logic.condition_block",
                          "base_type": "activity",
                          "properties": {
                            "condition": {
                              "left_operand": "$activity.definition_activity_01VHGK54ZX6L50UG1hIdhj7ccbdwhrkDeSd.output.succeeded$",
                              "operator": "eq",
                              "right_operand": false
                            },
                            "continue_on_failure": false,
                            "display_name": "No",
                            "skip_execution": false
                          },
                          "object_type": "definition_activity",
                          "actions": [
                            {
                              "unique_name": "definition_activity_01VHGK58YZ8593fnKGEfc3mdh7pwdlhS6Ys",
                              "name": "Continue",
                              "title": "Skip this observable",
                              "type": "logic.continue",
                              "base_type": "activity",
                              "properties": {
                                "continue_on_failure": false,
                                "display_name": "Skip this observable",
                                "skip_execution": false
                              },
                              "object_type": "definition_activity"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "unique_name": "definition_activity_01VHGK59X5PNK0YckGFtQX6kioj3oMPOAQu",
                      "name": "For Each",
                      "title": "For each enriched module",
                      "type": "logic.for_each",
                      "base_type": "activity",
                      "properties": {
                        "continue_on_failure": false,
                        "display_name": "For each enriched module",
                        "skip_execution": false,
                        "source_array": "$activity.definition_activity_01VHGK54ZX6L50UG1hIdhj7ccbdwhrkDeSd.output.read_table_from_json$"
                      },
                      "object_type": "definition_activity",
                      "actions": [
                        {
                          "unique_name": "definition_activity_01VHGK5BLJHTE6mYNwTpWTDD04FiB7Oj99G",
                          "name": "JSONPath Query",
                          "title": "Extract sightings",
                          "type": "corejava.jsonpathquery",
                          "base_type": "activity",
                          "properties": {
                            "action_timeout": 180,
                            "continue_on_failure": true,
                            "display_name": "Extract sightings",
                            "input_json": "$activity.definition_activity_01VHGK59X5PNK0YckGFtQX6kioj3oMPOAQu.input.source_array[@].data$",
                            "jsonpath_queries": [
                              {
                                "jsonpath_query": "$.sightings.count",
                                "jsonpath_query_name": "sightingCount",
                                "jsonpath_query_type": "string"
                              },
                              {
                                "jsonpath_query": "$.sightings.docs",
                                "jsonpath_query_name": "sightingData",
                                "jsonpath_query_type": "string"
                              }
                            ],
                            "skip_execution": false
                          },
                          "object_type": "definition_activity"
                        },
                        {
                          "unique_name": "definition_activity_01VHGK5CPUOBK02QLeNmkwBZXd5GCVtsHWr",
                          "name": "Condition Block",
                          "title": "Do we care about this module?",
                          "type": "logic.if_else",
                          "base_type": "activity",
                          "properties": {
                            "continue_on_failure": false,
                            "display_name": "Do we care about this module?",
                            "skip_execution": false
                          },
                          "object_type": "definition_activity",
                          "blocks": [
                            {
                              "unique_name": "definition_activity_01VHGK5DSUU3G3rI1r8AYizBvMB70TFTBuP",
                              "name": "Condition Branch",
                              "title": "No sightings, skip it",
                              "type": "logic.condition_block",
                              "base_type": "activity",
                              "properties": {
                                "condition": {
                                  "left_operand": "$activity.definition_activity_01VHGK5BLJHTE6mYNwTpWTDD04FiB7Oj99G.output.succeeded$",
                                  "operator": "eq",
                                  "right_operand": false
                                },
                                "continue_on_failure": false,
                                "display_name": "No sightings, skip it",
                                "skip_execution": false
                              },
                              "object_type": "definition_activity",
                              "actions": [
                                {
                                  "unique_name": "definition_activity_01VHGK5EXS2C30I8s765SWoOmNCuFyxbJqo",
                                  "name": "Continue",
                                  "title": "Skip this module",
                                  "type": "logic.continue",
                                  "base_type": "activity",
                                  "properties": {
                                    "continue_on_failure": false,
                                    "display_name": "Skip this module",
                                    "skip_execution": false
                                  },
                                  "object_type": "definition_activity"
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "unique_name": "definition_activity_01VIHA8344Y2A5conT2q83N9BUiZJMdMxs8",
                          "name": "Execute Python Script",
                          "title": "Extract sightings and remove ID",
                          "type": "python3.script",
                          "base_type": "activity",
                          "properties": {
                            "action_timeout": 180,
                            "continue_on_failure": false,
                            "display_name": "Extract sightings and remove ID",
                            "script": "import sys,json\nsightings = json.loads(sys.argv[1])\nsightings_dict = {\"sightings\":[]}\n\n# loop through all sighting of module\nfor sighting in sightings: \n  if \"targets\" in sighting.keys() and len(sighting[\"targets\"]) > 0:\n    if \"sxo-sighting\" in sighting[\"source\"] or \"securex-orchestration\" in sighting[\"source\"]:\n      continue\n    else: \n      # delete ID so sighting JSON can be used to create a non-ephemeral sighting\n      del sighting[\"id\"]\n      sighting[\"source\"] = sighting[\"source\"] + \" - sxo-sighting\"\n    # loop through targets' observables to look for best idenitifier \n    for target in sighting[\"targets\"]:\n        # walk through target types and assign priority to hostname or mac_address for incident title\n        for observable in target[\"observables\"]:\n            if \"hostname\" in observable.values():\n                temp_dict = {\n                    \"target_value\": [observable[\"value\"] for observable in target[\"observables\"] if observable[\"type\"] == \"hostname\"][0],\n                    \"target_type\": \"hostname\",\n                    \"observed_time\": target[\"observed_time\"][\"start_time\"],\n                    \"sighting_json\": sighting\n                }\n                sightings_dict[\"sightings\"].append(temp_dict)\n                break\n            elif \"mac_address\" in target[\"observables\"].values():\n                temp_dict = {\n                    \"target_value\": [observable[\"value\"] for observable in target[\"observables\"] if observable[\"type\"] == \"mac_address\"][0],\n                    \"target_type\": \"mac_address\",\n                    \"observed_time\": target[\"observed_time\"][\"start_time\"],\n                    \"sighting_json\": sighting\n                }\n                sightings_dict[\"sightings\"].append(temp_dict)\n                break\n            # if no hostname or mac, choose first target (make more advanced later)\n            else:\n                temp_dict = {\n                    \"target_value\": observable[0][\"value\"],\n                    \"target_type\": observable[0][\"type\"],\n                    \"observed_time\": target[\"observed_time\"][\"start_time\"],\n                    \"sighting_json\": sighting\n                }\n                sightings_dict[\"sightings\"].append(temp_dict)\n                break\n# dump all target sightings\nsighting_json = json.dumps(sightings_dict)",
                            "script_arguments": [
                              "$activity.definition_activity_01VHGK5BLJHTE6mYNwTpWTDD04FiB7Oj99G.output.jsonpath_queries.sightingData$"
                            ],
                            "script_queries": [
                              {
                                "script_query": "sighting_json",
                                "script_query_name": "sighting_json",
                                "script_query_type": "string"
                              }
                            ],
                            "skip_execution": false
                          },
                          "object_type": "definition_activity"
                        },
                        {
                          "unique_name": "definition_activity_01VIHE95M86CL4D4txgtbfqc2CxfRyjUAUI",
                          "name": "Read Table from JSON",
                          "title": "Read sightings from JSON",
                          "type": "corejava.read_table_from_json",
                          "base_type": "activity",
                          "properties": {
                            "action_timeout": 180,
                            "continue_on_failure": true,
                            "display_name": "Read sightings from JSON",
                            "input_json": "$activity.definition_activity_01VIHA8344Y2A5conT2q83N9BUiZJMdMxs8.output.script_queries.sighting_json$",
                            "jsonpath_query": "$.sightings[*]",
                            "persist_output": false,
                            "populate_columns": false,
                            "skip_execution": false,
                            "table_columns": [
                              {
                                "column_name": "sighting_json",
                                "column_type": "string"
                              },
                              {
                                "column_name": "target_value",
                                "column_type": "string"
                              },
                              {
                                "column_name": "target_type",
                                "column_type": "string"
                              },
                              {
                                "column_name": "observed_time",
                                "column_type": "string"
                              }
                            ]
                          },
                          "object_type": "definition_activity"
                        },
                        {
                          "unique_name": "definition_activity_01VIHGA3QAGQ97AmqLz9CBVtN6RybqTAHHp",
                          "name": "Condition Block",
                          "title": "Do we care about this module?",
                          "type": "logic.if_else",
                          "base_type": "activity",
                          "properties": {
                            "continue_on_failure": false,
                            "display_name": "Do we care about this module?",
                            "skip_execution": false
                          },
                          "object_type": "definition_activity",
                          "blocks": [
                            {
                              "unique_name": "definition_activity_01VIHGA3QB2UW2dOQ3lpDcF2lAXDX3bUQY6",
                              "name": "Condition Branch",
                              "title": "No sightings with targets, skip it",
                              "type": "logic.condition_block",
                              "base_type": "activity",
                              "properties": {
                                "condition": {
                                  "left_operand": "$activity.definition_activity_01VIHE95M86CL4D4txgtbfqc2CxfRyjUAUI.output.succeeded$",
                                  "operator": "eq",
                                  "right_operand": false
                                },
                                "continue_on_failure": false,
                                "display_name": "No sightings with targets, skip it",
                                "skip_execution": false
                              },
                              "object_type": "definition_activity",
                              "actions": [
                                {
                                  "unique_name": "definition_activity_01VIHGA3QCGKN3uVIoaZImJCByWizr1CtOV",
                                  "name": "Continue",
                                  "title": "Skip this module",
                                  "type": "logic.continue",
                                  "base_type": "activity",
                                  "properties": {
                                    "continue_on_failure": false,
                                    "display_name": "Skip this module",
                                    "skip_execution": false
                                  },
                                  "object_type": "definition_activity"
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "unique_name": "definition_activity_01VHK5EP8YPBV2CSOTC0NUoHZ78C9JN6CQa",
                          "name": "For Each",
                          "title": "For Each Target Sighting",
                          "type": "logic.for_each",
                          "base_type": "activity",
                          "properties": {
                            "continue_on_failure": false,
                            "display_name": "For Each Target Sighting",
                            "skip_execution": false,
                            "source_array": "$activity.definition_activity_01VIHE95M86CL4D4txgtbfqc2CxfRyjUAUI.output.read_table_from_json$"
                          },
                          "object_type": "definition_activity",
                          "actions": [
                            {
                              "unique_name": "definition_activity_01VJ2771SSGK94KMT2Gvl0cIPLBMpOD6HO9",
                              "name": "CHRIVAND-Incident-Correlator",
                              "title": "CHRIVAND-Incident-Correlator",
                              "type": "workflow.sub_workflow",
                              "base_type": "subworkflow",
                              "properties": {
                                "continue_on_failure": false,
                                "display_name": "CHRIVAND-Incident-Correlator",
                                "input": {
                                  "variable_workflow_01VD4NHUD14JV2TlKlLwn8HdCHzXz0TrfNB": "$activity.definition_activity_01VHGK4P3EN5Y5svpbcpYipGoQ7GcHxGpfa.input.source_array[@].value$",
                                  "variable_workflow_01VD4NPNSCW0F6vvq97gA5KO7lXvpIl2ND5": "$activity.definition_activity_01VHGK4P3EN5Y5svpbcpYipGoQ7GcHxGpfa.input.source_array[@].type$",
                                  "variable_workflow_01VD4YRYRMW8532zhQaoOfY629Qj5vTpuSa": "$activity.definition_activity_01VHK5EP8YPBV2CSOTC0NUoHZ78C9JN6CQa.input.source_array[@].target_type$",
                                  "variable_workflow_01VD4YZI81I7P1b9txHYeMm527CBF59shW7": "$activity.definition_activity_01VHK5EP8YPBV2CSOTC0NUoHZ78C9JN6CQa.input.source_array[@].target_value$",
                                  "variable_workflow_01VHEQPFXLIP95GrisWs7xrgxD9Fci4C35z": "$activity.definition_activity_01VHGK59X5PNK0YckGFtQX6kioj3oMPOAQu.input.source_array[@].module$",
                                  "variable_workflow_01VHEU89Z65P92KxG0rtUtBkx2dZ3oqXuJv": "$activity.definition_activity_01VHK5EP8YPBV2CSOTC0NUoHZ78C9JN6CQa.input.source_array[@].observed_time$",
                                  "variable_workflow_01VIH309ZQ9QB7VgAMof4Ur2l7gDGtBsou2": "$activity.definition_activity_01VHK5EP8YPBV2CSOTC0NUoHZ78C9JN6CQa.input.source_array[@].sighting_json$"
                                },
                                "runtime_user": {
                                  "target_default": true
                                },
                                "skip_execution": false,
                                "target": {
                                  "no_target": true
                                },
                                "workflow_id": "definition_workflow_01VD4MM2MXRP737N3XKcTIiAispvnk5Ixn9"
                              },
                              "object_type": "definition_activity"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "unique_name": "definition_activity_01VHGK5I99SXG6kURyLgjjkt5QhcRldmvWl",
              "name": "Group",
              "title": "Validate Threat Response token",
              "type": "logic.group",
              "base_type": "activity",
              "properties": {
                "continue_on_failure": false,
                "display_name": "Validate Threat Response token",
                "skip_execution": false
              },
              "object_type": "definition_activity",
              "actions": [
                {
                  "unique_name": "definition_activity_01VHGK5JNCEJV1URac4LVuscx4lAQGnahYr",
                  "name": "Calculate Date Time Difference",
                  "title": "Check token age",
                  "type": "core.calculate_date_time_difference",
                  "base_type": "activity",
                  "properties": {
                    "continue_on_failure": false,
                    "display_name": "Check token age",
                    "original_date": "$activity.definition_activity_01VHGK4NRJ16T72dbF5fFbCCDuEbhKIWgMB.output.end_time$",
                    "skip_execution": false,
                    "subtract_date": "$workflow.definition_workflow_01VHGK34JQZ6R3oyuGQeLVFrr99ezVGpNHM.local.variable_workflow_01VHGK34Q8M6L1GyaWk6uiqBrIRm9fCVflA$"
                  },
                  "object_type": "definition_activity"
                },
                {
                  "unique_name": "definition_activity_01VHGK5KY3UI20AB4fah7nvyTf5sy6f7ys9",
                  "name": "Condition Block",
                  "title": "Is it over 8 minutes?",
                  "type": "logic.if_else",
                  "base_type": "activity",
                  "properties": {
                    "continue_on_failure": false,
                    "display_name": "Is it over 8 minutes?",
                    "skip_execution": false
                  },
                  "object_type": "definition_activity",
                  "blocks": [
                    {
                      "unique_name": "definition_activity_01VHGK5LXAVQJ6sffgdvhLGZYw485Iv1zh2",
                      "name": "Condition Branch",
                      "title": "Yes",
                      "type": "logic.condition_block",
                      "base_type": "activity",
                      "properties": {
                        "condition": {
                          "left_operand": "$activity.definition_activity_01VHGK5JNCEJV1URac4LVuscx4lAQGnahYr.output.total_minutes$",
                          "operator": "gte",
                          "right_operand": 8
                        },
                        "continue_on_failure": false,
                        "display_name": "Yes",
                        "skip_execution": false
                      },
                      "object_type": "definition_activity",
                      "actions": [
                        {
                          "unique_name": "definition_activity_01VHGK5NHAN735mIKsUdXWpme5hTAu2DIyj",
                          "name": "Threat Response - Generate Access Token",
                          "title": "Threat Response - Generate Access Token",
                          "type": "workflow.atomic_workflow",
                          "base_type": "subworkflow",
                          "properties": {
                            "continue_on_failure": false,
                            "display_name": "Threat Response - Generate Access Token",
                            "runtime_user": {
                              "target_default": true
                            },
                            "skip_execution": false,
                            "target": {
                              "override_workflow_target_group_criteria": true,
                              "target_group": {
                                "run_on_all_targets": false,
                                "use_criteria": {
                                  "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                                  "conditions": [
                                    {
                                      "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                                      "operator": "eqi",
                                      "right_operand": "CTR_For_Access_Token"
                                    }
                                  ]
                                }
                              }
                            },
                            "workflow_id": "definition_workflow_01PP75S3LTBW4420OZU3rdHWKHFnE6aC7yH"
                          },
                          "object_type": "definition_activity"
                        },
                        {
                          "unique_name": "definition_activity_01VHGK5OQQH1O5iHtbYSAiJ7c1MmpfgTxFX",
                          "name": "Set Variables",
                          "title": "Set local token variables",
                          "type": "core.set_multiple_variables",
                          "base_type": "activity",
                          "properties": {
                            "continue_on_failure": false,
                            "display_name": "Set local token variables",
                            "skip_execution": false,
                            "variables_to_update": [
                              {
                                "variable_to_update": "$workflow.definition_workflow_01VHGK34JQZ6R3oyuGQeLVFrr99ezVGpNHM.local.variable_workflow_01VHGK34Q700O4jJHNJ5U8mW1DzWfcnRZO4$",
                                "variable_value_new": "$activity.definition_activity_01VHGK5NHAN735mIKsUdXWpme5hTAu2DIyj.output.variable_workflow_01PP75S3G7CJY6WAQr2IJC7qga2SIoE09gQ$"
                              },
                              {
                                "variable_to_update": "$workflow.definition_workflow_01VHGK34JQZ6R3oyuGQeLVFrr99ezVGpNHM.local.variable_workflow_01VHGK34Q8M6L1GyaWk6uiqBrIRm9fCVflA$",
                                "variable_value_new": "$activity.definition_activity_01VHGK5NHAN735mIKsUdXWpme5hTAu2DIyj.output.start_time$"
                              }
                            ]
                          },
                          "object_type": "definition_activity"
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        }
      ],
      "categories": [
        "category_1BMfMXSnJMyt5Ihqi7rWJr5N8cf"
      ]
    },
    "triggers": {
      "triggerschedule_01VYH0VVH3Z0675HTHwaCGmSpbRUxYYF8hZ": {
        "workflow_id": "definition_workflow_01VHGK34JQZ6R3oyuGQeLVFrr99ezVGpNHM",
        "name": "Run Every Hour",
        "title": "",
        "lowercase_name": "schedule.run_every_hour",
        "type": "schedule",
        "base_type": "trigger",
        "ref_id": "schedule_01HW8M7A8CQK71LT9IHmr0kCTBJURhLdFDQ",
        "version": "1.0.0",
        "disabled": true,
        "unique_name": "triggerschedule_01VYH0VVH3Z0675HTHwaCGmSpbRUxYYF8hZ",
        "object_type": "triggerschedule"
      }
    },
    "schedules": {
      "schedule_01HW8M7A8CQK71LT9IHmr0kCTBJURhLdFDQ": {
        "unique_name": "schedule_01HW8M7A8CQK71LT9IHmr0kCTBJURhLdFDQ",
        "name": "EVERY HOUR",
        "type": "basic.schedule",
        "base_type": "schedule",
        "properties": {
          "calendar": "calendar_recurring_1BMfMWvgiDhSjBQ7hTSyvz3NyVZ",
          "timezone": "Etc/GMT+0",
          "starttime": "01:00",
          "interval_hours": 1,
          "interval_minutes": 0,
          "number_of_times": 23,
          "display_name": "EVERY HOUR",
          "description": ""
        },
        "version": "1.0.0",
        "object_type": "schedule"
      }
    },
    "targets": {
      "definition_target_01FY04GSF89R66tMTam54wFWPLFn81QFsbL": {
        "unique_name": "definition_target_01FY04GSF89R66tMTam54wFWPLFn81QFsbL",
        "name": "Private_CTIA_Target",
        "title": "Private_CTIA_Target",
        "type": "web-service.endpoint",
        "base_type": "target",
        "object_type": "definition_target",
        "properties": {
          "description": "Private_CTIA_Target",
          "disable_certificate_validation": true,
          "display_name": "Private_CTIA_Target",
          "host": "private.intel.amp.cisco.com",
          "no_runtime_user": true,
          "protocol": "https"
        }
      },
      "definition_target_01G9UGF18RL9E08ziyLuERwNvdLp5Y7JqZ1": {
        "unique_name": "definition_target_01G9UGF18RL9E08ziyLuERwNvdLp5Y7JqZ1",
        "name": "Webex Teams",
        "title": "Webex Teams",
        "type": "web-service.endpoint",
        "base_type": "target",
        "object_type": "definition_target",
        "properties": {
          "description": "Webex Teams",
          "disable_certificate_validation": false,
          "display_name": "Webex Teams",
          "host": "webexapis.com",
          "no_runtime_user": true,
          "port": 443,
          "protocol": "https"
        }
      },
      "definition_target_01V5QNLTHNDV240FOQQOQBy1XTL2Vm2fN7I": {
        "unique_name": "definition_target_01V5QNLTHNDV240FOQQOQBy1XTL2Vm2fN7I",
        "name": "CHRIVAND - SECUREX ALL",
        "title": "CHRIVAND - SECUREX ALL",
        "type": "web-service.endpoint",
        "base_type": "target",
        "object_type": "definition_target",
        "properties": {
          "default_runtime_user_id": "definition_runtime_user_01V5QNETHRISW7YeLDs2YQpLaMWjSk9XlvD",
          "disable_certificate_validation": false,
          "display_name": "CHRIVAND - SECUREX ALL",
          "host": "visibility.amp.cisco.com",
          "ignore_proxy": false,
          "no_runtime_user": false,
          "path": "/iroh",
          "protocol": "https"
        }
      },
      "definition_target_01VHGXEUKA38Q01MTwjOxz5Ea9HvrlDDqWQ": {
        "unique_name": "definition_target_01VHGXEUKA38Q01MTwjOxz5Ea9HvrlDDqWQ",
        "name": "Twitter v2 API",
        "title": "Twitter v2 API",
        "type": "web-service.endpoint",
        "base_type": "target",
        "object_type": "definition_target",
        "properties": {
          "disable_certificate_validation": false,
          "display_name": "Twitter v2 API",
          "host": "api.twitter.com",
          "ignore_proxy": false,
          "no_runtime_user": true,
          "path": "/2/",
          "protocol": "https"
        }
      }
    },
    "runtime_users": {
      "definition_runtime_user_01V5QNETHRISW7YeLDs2YQpLaMWjSk9XlvD": {
        "unique_name": "definition_runtime_user_01V5QNETHRISW7YeLDs2YQpLaMWjSk9XlvD",
        "name": "CHRIVAND _ SECUREX _ ALL",
        "title": "CHRIVAND _ SECUREX _ ALL",
        "type": "runtime_user.web-service_basic_credentials",
        "base_type": "runtime_user",
        "object_type": "definition_runtime_user",
        "properties": {
          "auth_option": "*****",
          "basic_password": "*****",
          "basic_username": "*****",
          "display_name": "CHRIVAND _ SECUREX _ ALL"
        }
      }
    },
    "target_groups": {
      "target_group_01EJ0TQWPQWBD0qiWqClJKj9FOzwiZRfOFH": {
        "unique_name": "target_group_01EJ0TQWPQWBD0qiWqClJKj9FOzwiZRfOFH",
        "name": "Default TargetGroup",
        "title": "Default TargetGroup",
        "type": "generic.target_group",
        "base_type": "target_group",
        "version": "1.0.0",
        "targets": [
          {
            "data_target_type": "web-service.endpoint",
            "view_target_type": "web-service.endpoint",
            "include_all_targets": true
          },
          {
            "data_target_type": "email.smtp_endpoint",
            "view_target_type": "email.smtp_endpoint",
            "include_all_targets": true
          }
        ],
        "object_type": "target_group"
      }
    },
    "variables": {
      "variable_01VHHLD64C3I65TJbsXR4ePJ1ZxyArK2XOa": {
        "unique_name": "variable_01VHHLD64C3I65TJbsXR4ePJ1ZxyArK2XOa",
        "properties": {
          "value": "1508382262655602692",
          "scope": "global",
          "name": "twitter_since_id",
          "type": "datatype.string",
          "description": "Since ID used for Twitter Standard Search API: https://developer.twitter.com/en/docs/twitter-api/v1/tweets/search/api-reference/get-search-tweets",
          "is_required": false,
          "is_invisible": false
        },
        "object_type": "variable"
      }
    },
    "subworkflows": [
      {
        "workflow": {
          "unique_name": "definition_workflow_01VD4MM2MXRP737N3XKcTIiAispvnk5Ixn9",
          "name": "CHRIVAND-Incident-Correlator",
          "title": "CHRIVAND-Incident-Correlator",
          "type": "generic.workflow",
          "base_type": "workflow",
          "variables": [
            {
              "schema_id": "datatype.string",
              "properties": {
                "value": "",
                "scope": "local",
                "name": "prior_incident_confidence",
                "type": "datatype.string",
                "is_required": false,
                "is_invisible": false
              },
              "unique_name": "variable_workflow_01VGO2U1HN7EM4GgG59D5iHG6rpYtA8H8JD",
              "object_type": "variable_workflow"
            },
            {
              "schema_id": "datatype.string",
              "properties": {
                "value": "hostname",
                "scope": "input",
                "name": "target_type",
                "type": "datatype.string",
                "is_required": false,
                "is_invisible": false
              },
              "unique_name": "variable_workflow_01VD4YRYRMW8532zhQaoOfY629Qj5vTpuSa",
              "object_type": "variable_workflow"
            },
            {
              "schema_id": "datatype.string",
              "properties": {
                "value": "",
                "scope": "local",
                "name": "prior_incident_description",
                "type": "datatype.string",
                "is_required": false,
                "is_invisible": false
              },
              "unique_name": "variable_workflow_01VGO29U0AJYZ1sXnEQFwAeZFUcQnxXE13R",
              "object_type": "variable_workflow"
            },
            {
              "schema_id": "datatype.string",
              "properties": {
                "value": "2021-01-06T19:00:58+00:00",
                "scope": "input",
                "name": "target_observed_time",
                "type": "datatype.string",
                "is_required": false,
                "is_invisible": false
              },
              "unique_name": "variable_workflow_01VHEU89Z65P92KxG0rtUtBkx2dZ3oqXuJv",
              "object_type": "variable_workflow"
            },
            {
              "schema_id": "datatype.string",
              "properties": {
                "value": "",
                "scope": "local",
                "name": "prior_incident_id_full",
                "type": "datatype.string",
                "is_required": false,
                "is_invisible": false
              },
              "unique_name": "variable_workflow_01VD8NMC1QOBW72m7FZTKKpCNKBbhstcPLm",
              "object_type": "variable_workflow"
            },
            {
              "schema_id": "datatype.string",
              "properties": {
                "value": "johndoe88",
                "scope": "input",
                "name": "target_value",
                "type": "datatype.string",
                "is_required": false,
                "is_invisible": false
              },
              "unique_name": "variable_workflow_01VD4YZI81I7P1b9txHYeMm527CBF59shW7",
              "object_type": "variable_workflow"
            },
            {
              "schema_id": "datatype.string",
              "properties": {
                "value": "",
                "scope": "local",
                "name": "prior_incident_id_split",
                "type": "datatype.string",
                "is_required": false,
                "is_invisible": false
              },
              "unique_name": "variable_workflow_01VGO0H7UA5A75yQGvRaJdhyriWUnEs7VD9",
              "object_type": "variable_workflow"
            },
            {
              "schema_id": "datatype.string",
              "properties": {
                "value": "url",
                "scope": "input",
                "name": "ioc_type",
                "type": "datatype.string",
                "is_required": false,
                "is_invisible": false
              },
              "unique_name": "variable_workflow_01VD4NPNSCW0F6vvq97gA5KO7lXvpIl2ND5",
              "object_type": "variable_workflow"
            },
            {
              "schema_id": "datatype.string",
              "properties": {
                "value": "{\"severity\": \"Low\", \"internal\": true, \"confidence\": \"High\", \"count\": 1, \"description\": \"Outgoing connection Sighting\", \"source\": \"AMP Event\", \"type\": \"sighting\", \"targets\": [{\"observables\": [{\"type\": \"hostname\", \"value\": \"heimdallr\"}, {\"type\": \"amp_computer_guid\", \"value\": \"b1e0a6a9-c891-4cf9-9a03-f82fc5298cca\"}, {\"type\": \"ip\", \"value\": \"192.168.70.220\"}, {\"type\": \"mac_address\", \"value\": \"00:0c:29:0f:6f:0a\"}], \"observed_time\": {\"start_time\": \"2022-02-07T17:18:28.000Z\"}, \"os\": \"Windows 10 Enterprise\", \"type\": \"endpoint\"}], \"source_uri\": \"https://console.amp.cisco.com/computers/b1e0a6a9-c891-4cf9-9a03-f82fc5298cca/trajectory?q=cnc.verybaddomain.net\", \"client_id\": \"34d94c8c-2041-4708-8172-ebe2df295ca9\", \"schema_version\": \"1.1.3\", \"observables\": [{\"type\": \"url\", \"value\": \"https://ictoms.site/ictom.zip\"}], \"observed_time\": {\"start_time\": \"2022-02-07T17:18:28.000Z\"}, \"tlp\": \"amber\", \"sensor\": \"endpoint\", \"relations\": [{\"related\": {\"type\": \"url\", \"value\": \"http://cnc.verybaddomain.net:8080/f1ffmJstxGc1mDSZV5lh_AId7A6U-hnDAOzwW2pg7oSJwVg_zkCl47hyAyalJaOXJ/\"}, \"origin\": \"AMP Enrichment Module\", \"source\": {\"type\": \"sha256\", \"value\": \"ccb3c35e5da7b80d3dcb9c8121ca6e318d201a576b251739b1b06093d7084ca7\"}, \"relation\": \"Connected_To\"}, {\"related\": {\"type\": \"url\", \"value\": \"http://cnc.verybaddomain.net:8080/f1ffmJstxGc1mDSZV5lh_AId7A6U-hnDAOzwW2pg7oSJwVg_zkCl47hyAyalJaOXJ/\"}, \"origin\": \"AMP Enrichment Module\", \"source\": {\"type\": \"ip\", \"value\": \"192.168.70.220\"}, \"relation\": \"Connected_To\"}, {\"related\": {\"type\": \"ip\", \"value\": \"3.70.242.10\"}, \"origin\": \"AMP Enrichment Module\", \"source\": {\"type\": \"ip\", \"value\": \"192.168.70.220\"}, \"relation\": \"Connected_To\"}, {\"related\": {\"type\": \"ip\", \"value\": \"3.70.242.10\"}, \"origin\": \"AMP Enrichment Module\", \"source\": {\"type\": \"sha256\", \"value\": \"ccb3c35e5da7b80d3dcb9c8121ca6e318d201a576b251739b1b06093d7084ca7\"}, \"relation\": \"Connected_To\"}, {\"related\": {\"type\": \"ip\", \"value\": \"3.70.242.10\"}, \"origin\": \"AMP Enrichment Module\", \"source\": {\"type\": \"url\", \"value\": \"http://cnc.verybaddomain.net:8080/f1ffmJstxGc1mDSZV5lh_AId7A6U-hnDAOzwW2pg7oSJwVg_zkCl47hyAyalJaOXJ/\"}, \"relation\": \"Hosted_By\"}], \"timestamp\": \"2022-03-09T17:44:37.639Z\"}",
                "scope": "input",
                "name": "sighting_json",
                "type": "datatype.string",
                "description": "Takes in a JSON object of a sigthing WITHOUT the ID. ",
                "is_required": false,
                "is_invisible": false
              },
              "unique_name": "variable_workflow_01VIH309ZQ9QB7VgAMof4Ur2l7gDGtBsou2",
              "object_type": "variable_workflow"
            },
            {
              "schema_id": "datatype.string",
              "properties": {
                "value": "",
                "scope": "local",
                "name": "prior_incident_status",
                "type": "datatype.string",
                "is_required": false,
                "is_invisible": false
              },
              "unique_name": "variable_workflow_01VGO2YO0W2LF4V1Q8GGoPHk0962BEaP6ZM",
              "object_type": "variable_workflow"
            },
            {
              "schema_id": "datatype.secure_string",
              "properties": {
                "value": "*****",
                "scope": "local",
                "name": "Webex Token",
                "type": "datatype.secure_string",
                "is_required": false,
                "is_invisible": false
              },
              "unique_name": "variable_workflow_01VF27Y5PS5P041xwV8hBeKejbNIzMkh0RB",
              "object_type": "variable_workflow"
            },
            {
              "schema_id": "datatype.string",
              "properties": {
                "value": "https://ictoms.site/ictom.zip",
                "scope": "input",
                "name": "ioc_value",
                "type": "datatype.string",
                "is_required": false,
                "is_invisible": false
              },
              "unique_name": "variable_workflow_01VD4NHUD14JV2TlKlLwn8HdCHzXz0TrfNB",
              "object_type": "variable_workflow"
            },
            {
              "schema_id": "datatype.string",
              "properties": {
                "value": "Umbrella",
                "scope": "input",
                "name": "event_source",
                "type": "datatype.string",
                "is_required": false,
                "is_invisible": false
              },
              "unique_name": "variable_workflow_01VHEQPFXLIP95GrisWs7xrgxD9Fci4C35z",
              "object_type": "variable_workflow"
            },
            {
              "schema_id": "datatype.string",
              "properties": {
                "value": "",
                "scope": "local",
                "name": "sighting_id",
                "type": "datatype.string",
                "is_required": false,
                "is_invisible": false
              },
              "unique_name": "variable_workflow_01VIH3TI6L0EI0rdin3W6UvgMeYdgeaAROK",
              "object_type": "variable_workflow"
            }
          ],
          "properties": {
            "atomic": {
              "is_atomic": false
            },
            "delete_workflow_instance": false,
            "display_name": "CHRIVAND-Incident-Correlator",
            "runtime_user": {
              "target_default": true
            },
            "target": {
              "no_target": true
            }
          },
          "object_type": "definition_workflow",
          "actions": [
            {
              "unique_name": "definition_activity_01VD54Q5RCMVM1OqifPsp2rDm8IrFJqx2mW",
              "name": "Generate Access Token for SecureX",
              "title": "Generate Access Token for SecureX",
              "type": "workflow.atomic_workflow",
              "base_type": "subworkflow",
              "properties": {
                "continue_on_failure": false,
                "display_name": "Generate Access Token for SecureX",
                "runtime_user": {
                  "target_default": true
                },
                "skip_execution": false,
                "target": {
                  "override_workflow_target": true,
                  "target_id": "definition_target_01V5QNLTHNDV240FOQQOQBy1XTL2Vm2fN7I",
                  "target_type": "web-service.endpoint"
                },
                "workflow_id": "definition_workflow_01KJXN35DBN5444diA78eCQ0YxYn8a7MMu6"
              },
              "object_type": "definition_activity"
            },
            {
              "unique_name": "definition_activity_01VIH1SCYFNNA4npBs16o5S21gvnTxRRaer",
              "name": "Group",
              "title": "THREAT RESPONSE - CREATE SIGHTING",
              "type": "logic.group",
              "base_type": "activity",
              "properties": {
                "continue_on_failure": false,
                "display_name": "THREAT RESPONSE - CREATE SIGHTING",
                "skip_execution": false
              },
              "object_type": "definition_activity",
              "actions": [
                {
                  "unique_name": "definition_activity_01VIH1SCYIYAX4lnmmJXPQ1vbq1gvEzsTzG",
                  "name": "HTTP Request",
                  "title": "Create Sighting",
                  "type": "web-service.http_request",
                  "base_type": "activity",
                  "properties": {
                    "accept": "application/json",
                    "action_timeout": 180,
                    "allow_auto_redirect": true,
                    "body": "$workflow.definition_workflow_01VD4MM2MXRP737N3XKcTIiAispvnk5Ixn9.input.variable_workflow_01VIH309ZQ9QB7VgAMof4Ur2l7gDGtBsou2$",
                    "content_type": "application/json",
                    "continue_on_error_status_code": false,
                    "continue_on_failure": true,
                    "custom_headers": [
                      {
                        "name": "Authorization",
                        "value": "Bearer $activity.definition_activity_01VD54Q5RCMVM1OqifPsp2rDm8IrFJqx2mW.output.variable_workflow_01KJXN351DZFM10HhZDCLEZwbRsHOXf3iw4$"
                      }
                    ],
                    "display_name": "Create Sighting",
                    "method": "POST",
                    "relative_url": "/ctia/sighting",
                    "runtime_user": {
                      "target_default": true
                    },
                    "skip_execution": false,
                    "target": {
                      "override_workflow_target": true,
                      "target_id": "definition_target_01FY04GSF89R66tMTam54wFWPLFn81QFsbL"
                    }
                  },
                  "object_type": "definition_activity"
                },
                {
                  "unique_name": "definition_activity_01VIH1SCYMM0Z0wc8IPgKEIxdxpq2Ooel4I",
                  "name": "Condition Block",
                  "title": "ERROR CHECKING",
                  "type": "logic.if_else",
                  "base_type": "activity",
                  "properties": {
                    "continue_on_failure": false,
                    "display_name": "ERROR CHECKING",
                    "skip_execution": false
                  },
                  "object_type": "definition_activity",
                  "blocks": [
                    {
                      "unique_name": "definition_activity_01VIH1SCYNOKX7WnalnHIGSD0FQOPrKLzZT",
                      "name": "Condition Branch",
                      "title": "not 201",
                      "type": "logic.condition_block",
                      "base_type": "activity",
                      "properties": {
                        "condition": {
                          "left_operand": "$activity.definition_activity_01VIH1SCYIYAX4lnmmJXPQ1vbq1gvEzsTzG.output.status_code$",
                          "operator": "ne",
                          "right_operand": 201
                        },
                        "continue_on_failure": false,
                        "display_name": "not 201",
                        "skip_execution": false
                      },
                      "object_type": "definition_activity",
                      "actions": [
                        {
                          "unique_name": "definition_activity_01VIH1SCYPJKP1BVJPmX7hmHU2apoyNPohC",
                          "name": "Completed",
                          "title": "Failed",
                          "type": "logic.completed",
                          "base_type": "activity",
                          "properties": {
                            "completion_type": "failed-completed",
                            "continue_on_failure": false,
                            "display_name": "Failed",
                            "result_message": "Failed",
                            "skip_execution": false
                          },
                          "object_type": "definition_activity"
                        }
                      ]
                    }
                  ]
                },
                {
                  "unique_name": "definition_activity_01VIH4SJNBPUQ5jn4mywPZ81csAy7Ddut1G",
                  "name": "JSONPath Query",
                  "title": "Grab sighting ID",
                  "type": "corejava.jsonpathquery",
                  "base_type": "activity",
                  "properties": {
                    "action_timeout": 180,
                    "continue_on_failure": false,
                    "display_name": "Grab sighting ID",
                    "input_json": "$activity.definition_activity_01VIH1SCYIYAX4lnmmJXPQ1vbq1gvEzsTzG.output.response_body$",
                    "jsonpath_queries": [
                      {
                        "jsonpath_query": "$.id",
                        "jsonpath_query_name": "sighting_id",
                        "jsonpath_query_type": "string"
                      }
                    ],
                    "skip_execution": false
                  },
                  "object_type": "definition_activity"
                },
                {
                  "unique_name": "definition_activity_01VIH47G13V900OUVktg8Y6K75wcsAyUT0E",
                  "name": "Set Variables",
                  "title": "Set sighintg ID",
                  "type": "core.set_multiple_variables",
                  "base_type": "activity",
                  "properties": {
                    "continue_on_failure": false,
                    "display_name": "Set sighintg ID",
                    "skip_execution": false,
                    "variables_to_update": [
                      {
                        "variable_to_update": "$workflow.definition_workflow_01VD4MM2MXRP737N3XKcTIiAispvnk5Ixn9.local.variable_workflow_01VIH3TI6L0EI0rdin3W6UvgMeYdgeaAROK$",
                        "variable_value_new": "$activity.definition_activity_01VIH4SJNBPUQ5jn4mywPZ81csAy7Ddut1G.output.jsonpath_queries.sighting_id$"
                      }
                    ]
                  },
                  "object_type": "definition_activity"
                }
              ]
            },
            {
              "unique_name": "definition_activity_01VDFJRQFEY230IHBneQ1IZwX0vOcvCPm9I",
              "name": "Group",
              "title": "THREAT RESPONSE - SEARCH PRIOR INCIDENT FOR TARGET",
              "type": "logic.group",
              "base_type": "activity",
              "properties": {
                "continue_on_failure": false,
                "display_name": "THREAT RESPONSE - SEARCH PRIOR INCIDENT FOR TARGET",
                "skip_execution": false
              },
              "object_type": "definition_activity",
              "actions": [
                {
                  "unique_name": "definition_activity_01VDFJWTYS89F5RPSAePsWDPoi5zun4ds6K",
                  "name": "HTTP Request",
                  "title": "Search incidents",
                  "type": "web-service.http_request",
                  "base_type": "activity",
                  "properties": {
                    "accept": "application/json",
                    "action_timeout": 180,
                    "allow_auto_redirect": true,
                    "content_type": "application/json",
                    "continue_on_error_status_code": false,
                    "continue_on_failure": true,
                    "custom_headers": [
                      {
                        "name": "Authorization",
                        "value": "Bearer $activity.definition_activity_01VD54Q5RCMVM1OqifPsp2rDm8IrFJqx2mW.output.variable_workflow_01KJXN351DZFM10HhZDCLEZwbRsHOXf3iw4$"
                      }
                    ],
                    "display_name": "Search incidents",
                    "method": "GET",
                    "relative_url": "/ctia/incident/search?sort_order=desc&sort_by=incident_time.opened&search_fields=title&source=sxo-incident-correlator&query=$workflow.definition_workflow_01VD4MM2MXRP737N3XKcTIiAispvnk5Ixn9.input.variable_workflow_01VD4YZI81I7P1b9txHYeMm527CBF59shW7$",
                    "runtime_user": {
                      "target_default": true
                    },
                    "skip_execution": false,
                    "target": {
                      "override_workflow_target": true,
                      "target_id": "definition_target_01FY04GSF89R66tMTam54wFWPLFn81QFsbL"
                    }
                  },
                  "object_type": "definition_activity"
                },
                {
                  "unique_name": "definition_activity_01VDFKEACGCSF1UuR2DDKW2K8ZWvF8wfAsO",
                  "name": "Condition Block",
                  "title": "ERROR CHECKING",
                  "type": "logic.if_else",
                  "base_type": "activity",
                  "properties": {
                    "continue_on_failure": false,
                    "display_name": "ERROR CHECKING",
                    "skip_execution": false
                  },
                  "object_type": "definition_activity",
                  "blocks": [
                    {
                      "unique_name": "definition_activity_01VDFKEACGY7121BYT8wJeaFnClqNLUH7ah",
                      "name": "Condition Branch",
                      "title": "not 200",
                      "type": "logic.condition_block",
                      "base_type": "activity",
                      "properties": {
                        "condition": {
                          "left_operand": "$activity.definition_activity_01VDFJWTYS89F5RPSAePsWDPoi5zun4ds6K.output.status_code$",
                          "operator": "ne",
                          "right_operand": 200
                        },
                        "continue_on_failure": false,
                        "display_name": "not 200",
                        "skip_execution": false
                      },
                      "object_type": "definition_activity",
                      "actions": [
                        {
                          "unique_name": "definition_activity_01VDFKEACID2U0cjXYdKLuCaSsI2XvuOq6u",
                          "name": "Completed",
                          "title": "Failed",
                          "type": "logic.completed",
                          "base_type": "activity",
                          "properties": {
                            "completion_type": "failed-completed",
                            "continue_on_failure": false,
                            "display_name": "Failed",
                            "result_message": "Failed",
                            "skip_execution": false
                          },
                          "object_type": "definition_activity"
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "unique_name": "definition_activity_01VGNBMJBJJEJ2ESazrMC3aTG1L4DGQZ3ml",
              "name": "Group",
              "title": "PARSE OUTPUT",
              "type": "logic.group",
              "base_type": "activity",
              "properties": {
                "continue_on_failure": false,
                "display_name": "PARSE OUTPUT",
                "skip_execution": false
              },
              "object_type": "definition_activity",
              "actions": [
                {
                  "unique_name": "definition_activity_01VGNHVHS2GAK5XVZclj7Ty6lFVVicAqkPB",
                  "name": "Condition Block",
                  "title": "PRIOR INCIDENTS RETURNED FOR TARGET?",
                  "type": "logic.if_else",
                  "base_type": "activity",
                  "properties": {
                    "continue_on_failure": false,
                    "display_name": "PRIOR INCIDENTS RETURNED FOR TARGET?",
                    "skip_execution": false
                  },
                  "object_type": "definition_activity",
                  "blocks": [
                    {
                      "unique_name": "definition_activity_01VGNHVI6A44I2nwNGEtvfVUq35rSNsmFjn",
                      "name": "Condition Branch",
                      "title": "INCIDENTS RETURNED",
                      "type": "logic.condition_block",
                      "base_type": "activity",
                      "properties": {
                        "condition": {
                          "left_operand": "$activity.definition_activity_01VDFJWTYS89F5RPSAePsWDPoi5zun4ds6K.output.response_body$",
                          "operator": "ne",
                          "right_operand": "[]"
                        },
                        "continue_on_failure": false,
                        "display_name": "INCIDENTS RETURNED",
                        "skip_execution": false
                      },
                      "object_type": "definition_activity",
                      "actions": [
                        {
                          "unique_name": "definition_activity_01VD5GWUBCKY968KXZDe3BfmF11gowwLeVK",
                          "name": "JSONPath Query",
                          "title": "Pick most recent incident",
                          "type": "corejava.jsonpathquery",
                          "base_type": "activity",
                          "properties": {
                            "action_timeout": 180,
                            "continue_on_failure": false,
                            "display_name": "Pick most recent incident",
                            "input_json": "$activity.definition_activity_01VDFJWTYS89F5RPSAePsWDPoi5zun4ds6K.output.response_body$",
                            "jsonpath_queries": [
                              {
                                "jsonpath_query": "$.[0]",
                                "jsonpath_query_name": "first incident",
                                "jsonpath_query_type": "string"
                              }
                            ],
                            "skip_execution": false
                          },
                          "object_type": "definition_activity"
                        },
                        {
                          "unique_name": "definition_activity_01VDGL8UEJ7IO6zKgmDLPPd0KEEwkAqZkcc",
                          "name": "JSONPath Query",
                          "title": "Grab most recent incident details",
                          "type": "corejava.jsonpathquery",
                          "base_type": "activity",
                          "properties": {
                            "action_timeout": 180,
                            "continue_on_failure": false,
                            "display_name": "Grab most recent incident details",
                            "input_json": "$activity.definition_activity_01VD5GWUBCKY968KXZDe3BfmF11gowwLeVK.output.jsonpath_queries.first incident$",
                            "jsonpath_queries": [
                              {
                                "jsonpath_query": "$.description",
                                "jsonpath_query_name": "incident_description",
                                "jsonpath_query_type": "string"
                              },
                              {
                                "jsonpath_query": "$.confidence",
                                "jsonpath_query_name": "incident_confidence",
                                "jsonpath_query_type": "string"
                              },
                              {
                                "jsonpath_query": "$.id",
                                "jsonpath_query_name": "incident_id",
                                "jsonpath_query_type": "string"
                              },
                              {
                                "jsonpath_query": "$.status",
                                "jsonpath_query_name": "incident_status",
                                "jsonpath_query_type": "string"
                              }
                            ],
                            "skip_execution": false
                          },
                          "object_type": "definition_activity"
                        },
                        {
                          "unique_name": "definition_activity_01VDHGFALUWNW2JHZpHGu0L512JMLBYEYh7",
                          "name": "Split String",
                          "title": "Split most recent incident ID",
                          "type": "core.splitstring",
                          "base_type": "activity",
                          "properties": {
                            "boundaries": [
                              {
                                "boundary": "/"
                              }
                            ],
                            "continue_on_failure": false,
                            "display_name": "Split most recent incident ID",
                            "input_string": "$activity.definition_activity_01VDGL8UEJ7IO6zKgmDLPPd0KEEwkAqZkcc.output.jsonpath_queries.incident_id$",
                            "skip_execution": false
                          },
                          "object_type": "definition_activity"
                        },
                        {
                          "unique_name": "definition_activity_01VGNZ3S7AMUE7mJibp2U4LlmVyc2DUXFG7",
                          "name": "Set Variables",
                          "title": "Set Prior Incident Variables",
                          "type": "core.set_multiple_variables",
                          "base_type": "activity",
                          "properties": {
                            "continue_on_failure": false,
                            "display_name": "Set Prior Incident Variables",
                            "skip_execution": false,
                            "variables_to_update": [
                              {
                                "variable_to_update": "$workflow.definition_workflow_01VD4MM2MXRP737N3XKcTIiAispvnk5Ixn9.local.variable_workflow_01VD8NMC1QOBW72m7FZTKKpCNKBbhstcPLm$",
                                "variable_value_new": "$activity.definition_activity_01VDGL8UEJ7IO6zKgmDLPPd0KEEwkAqZkcc.output.jsonpath_queries.incident_id$"
                              },
                              {
                                "variable_to_update": "$workflow.definition_workflow_01VD4MM2MXRP737N3XKcTIiAispvnk5Ixn9.local.variable_workflow_01VGO0H7UA5A75yQGvRaJdhyriWUnEs7VD9$",
                                "variable_value_new": "$activity.definition_activity_01VDHGFALUWNW2JHZpHGu0L512JMLBYEYh7.output.parts[-1]$"
                              },
                              {
                                "variable_to_update": "$workflow.definition_workflow_01VD4MM2MXRP737N3XKcTIiAispvnk5Ixn9.local.variable_workflow_01VGO2YO0W2LF4V1Q8GGoPHk0962BEaP6ZM$",
                                "variable_value_new": "$activity.definition_activity_01VDGL8UEJ7IO6zKgmDLPPd0KEEwkAqZkcc.output.jsonpath_queries.incident_status$"
                              },
                              {
                                "variable_to_update": "$workflow.definition_workflow_01VD4MM2MXRP737N3XKcTIiAispvnk5Ixn9.local.variable_workflow_01VGO2U1HN7EM4GgG59D5iHG6rpYtA8H8JD$",
                                "variable_value_new": "$activity.definition_activity_01VDGL8UEJ7IO6zKgmDLPPd0KEEwkAqZkcc.output.jsonpath_queries.incident_confidence$"
                              },
                              {
                                "variable_to_update": "$workflow.definition_workflow_01VD4MM2MXRP737N3XKcTIiAispvnk5Ixn9.local.variable_workflow_01VGO29U0AJYZ1sXnEQFwAeZFUcQnxXE13R$",
                                "variable_value_new": "$activity.definition_activity_01VDGL8UEJ7IO6zKgmDLPPd0KEEwkAqZkcc.output.jsonpath_queries.incident_description$"
                              }
                            ]
                          },
                          "object_type": "definition_activity"
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "unique_name": "definition_activity_01VD5I6YRDBF04FAJgCVbwy1frjATCKjn5B",
              "name": "Condition Block",
              "title": "INCIDENTS RETURNED?",
              "type": "logic.if_else",
              "base_type": "activity",
              "properties": {
                "continue_on_failure": false,
                "display_name": "INCIDENTS RETURNED?",
                "skip_execution": false
              },
              "object_type": "definition_activity",
              "blocks": [
                {
                  "unique_name": "definition_activity_01VD5I6Z206YO4Ug6xGaIDEpgH2gDYyWdpU",
                  "name": "Condition Branch",
                  "title": "NO PRIOR INCIDENT or PRIOR INCIDENT CLOSED",
                  "type": "logic.condition_block",
                  "base_type": "activity",
                  "properties": {
                    "condition": {
                      "left_operand": {
                        "left_operand": "$activity.definition_activity_01VDFJWTYS89F5RPSAePsWDPoi5zun4ds6K.output.response_body$",
                        "operator": "eq",
                        "right_operand": "[]"
                      },
                      "operator": "or",
                      "right_operand": {
                        "left_operand": "$workflow.definition_workflow_01VD4MM2MXRP737N3XKcTIiAispvnk5Ixn9.local.variable_workflow_01VGO2YO0W2LF4V1Q8GGoPHk0962BEaP6ZM$",
                        "operator": "eq",
                        "right_operand": "Closed"
                      }
                    },
                    "continue_on_failure": false,
                    "display_name": "NO PRIOR INCIDENT or PRIOR INCIDENT CLOSED",
                    "skip_execution": false
                  },
                  "object_type": "definition_activity",
                  "actions": [
                    {
                      "unique_name": "definition_activity_01VDF9LLSLBW46xsr02ezpwdaRtqJObFUdr",
                      "name": "Group",
                      "title": "Threat Response - Create Incident",
                      "type": "logic.group",
                      "base_type": "activity",
                      "properties": {
                        "continue_on_failure": false,
                        "display_name": "Threat Response - Create Incident",
                        "skip_execution": false
                      },
                      "object_type": "definition_activity",
                      "actions": [
                        {
                          "unique_name": "definition_activity_01VDEIO7GEOV56QLHIHWLdtD6Myfupz5dcD",
                          "name": "Execute Python Script",
                          "title": "Create incident JSON",
                          "type": "python3.script",
                          "base_type": "activity",
                          "properties": {
                            "action_timeout": 180,
                            "continue_on_failure": false,
                            "display_name": "Create incident JSON",
                            "script": "import json, sys\nfrom datetime import datetime, date, timedelta\n\n# Get the current date/time\ndate_time = datetime.now()\ndate_formatted = date_time.strftime(\"%Y-%m-%dT%H:%M:%SZ\")\ntarget_value = sys.argv[1]\ntarget_type = sys.argv[2]\nioc_value = sys.argv[3]\nioc_type = sys.argv[4]\nevent_count = 1\n\n# Build the incident objects\nincident_object = {}\nincident_object[\"description\"] = f\"## Initial Detected Security Event:\\n\\nOn **{date_formatted}**, a target **{target_value}** of type [{target_type}] had the first security event due to IoC **{ioc_value}** of type [{ioc_type}].\\n\\n## Current Amount of Security Events for Target: `{event_count}`\\n\\n## Subsequent Security Events:\\n\\n\"\nincident_object[\"schema_version\"] = \"1.0.11\"\nincident_object[\"type\"] = \"incident\"\nincident_object[\"source\"] = \"sxo-incident-correlator\"\nincident_object[\"short_description\"] = f\"Correlated incident for: {target_value} [by SXO Incident Correlator]\"\nincident_object[\"title\"] = f\"Correlated incident for: {target_value} [by SXO Incident Correlator]\" \nincident_object[\"incident_time\"] = { \"discovered\": date_formatted, \"opened\": date_formatted }\nincident_object[\"status\"] = \"New\"\nincident_object[\"confidence\"] = \"Medium\"\n\nincident_json = json.dumps(incident_object)",
                            "script_arguments": [
                              "$workflow.definition_workflow_01VD4MM2MXRP737N3XKcTIiAispvnk5Ixn9.input.variable_workflow_01VD4YZI81I7P1b9txHYeMm527CBF59shW7$",
                              "$workflow.definition_workflow_01VD4MM2MXRP737N3XKcTIiAispvnk5Ixn9.input.variable_workflow_01VD4YRYRMW8532zhQaoOfY629Qj5vTpuSa$",
                              "$workflow.definition_workflow_01VD4MM2MXRP737N3XKcTIiAispvnk5Ixn9.input.variable_workflow_01VD4NHUD14JV2TlKlLwn8HdCHzXz0TrfNB$",
                              "$workflow.definition_workflow_01VD4MM2MXRP737N3XKcTIiAispvnk5Ixn9.input.variable_workflow_01VD4NPNSCW0F6vvq97gA5KO7lXvpIl2ND5$"
                            ],
                            "script_queries": [
                              {
                                "script_query": "incident_json",
                                "script_query_name": "incident_json",
                                "script_query_type": "string"
                              }
                            ],
                            "skip_execution": false
                          },
                          "object_type": "definition_activity"
                        },
                        {
                          "unique_name": "definition_activity_01VDEJ5FB2Z3S4EVq74oPMudc2j9HTCRUV3",
                          "name": "HTTP Request",
                          "title": "Create New Incident",
                          "type": "web-service.http_request",
                          "base_type": "activity",
                          "properties": {
                            "accept": "application/json",
                            "action_timeout": 180,
                            "allow_auto_redirect": true,
                            "body": "$activity.definition_activity_01VDEIO7GEOV56QLHIHWLdtD6Myfupz5dcD.output.script_queries.incident_json$",
                            "content_type": "application/json",
                            "continue_on_error_status_code": false,
                            "continue_on_failure": true,
                            "custom_headers": [
                              {
                                "name": "Authorization",
                                "value": "Bearer $activity.definition_activity_01VD54Q5RCMVM1OqifPsp2rDm8IrFJqx2mW.output.variable_workflow_01KJXN351DZFM10HhZDCLEZwbRsHOXf3iw4$"
                              }
                            ],
                            "display_name": "Create New Incident",
                            "method": "POST",
                            "relative_url": "/ctia/incident",
                            "runtime_user": {
                              "target_default": true
                            },
                            "skip_execution": false,
                            "target": {
                              "override_workflow_target": true,
                              "target_id": "definition_target_01FY04GSF89R66tMTam54wFWPLFn81QFsbL"
                            }
                          },
                          "object_type": "definition_activity"
                        },
                        {
                          "unique_name": "definition_activity_01VDF99PK25GN2cCjim6z9qBROFA9i200IV",
                          "name": "Condition Block",
                          "title": "ERROR CHECKING",
                          "type": "logic.if_else",
                          "base_type": "activity",
                          "properties": {
                            "continue_on_failure": false,
                            "display_name": "ERROR CHECKING",
                            "skip_execution": false
                          },
                          "object_type": "definition_activity",
                          "blocks": [
                            {
                              "unique_name": "definition_activity_01VDF99PK2YOR3e0HzHTNC07FsJbNqnuDFx",
                              "name": "Condition Branch",
                              "title": "not 201",
                              "type": "logic.condition_block",
                              "base_type": "activity",
                              "properties": {
                                "condition": {
                                  "left_operand": "$activity.definition_activity_01VDEJ5FB2Z3S4EVq74oPMudc2j9HTCRUV3.output.status_code$",
                                  "operator": "ne",
                                  "right_operand": 201
                                },
                                "continue_on_failure": false,
                                "display_name": "not 201",
                                "skip_execution": false
                              },
                              "object_type": "definition_activity",
                              "actions": [
                                {
                                  "unique_name": "definition_activity_01VDF99PK51703jC2zugE5VPPBcLLJ9NvCj",
                                  "name": "Completed",
                                  "title": "Failed",
                                  "type": "logic.completed",
                                  "base_type": "activity",
                                  "properties": {
                                    "completion_type": "failed-completed",
                                    "continue_on_failure": false,
                                    "display_name": "Failed",
                                    "result_message": "Failed",
                                    "skip_execution": false
                                  },
                                  "object_type": "definition_activity"
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "unique_name": "definition_activity_01VGKKNLW4ALO4diyZXbIlGJR8FohbGAW84",
                      "name": "JSONPath Query",
                      "title": "Grab new incident details",
                      "type": "corejava.jsonpathquery",
                      "base_type": "activity",
                      "properties": {
                        "action_timeout": 180,
                        "continue_on_failure": false,
                        "display_name": "Grab new incident details",
                        "input_json": "$activity.definition_activity_01VDEJ5FB2Z3S4EVq74oPMudc2j9HTCRUV3.output.response_body$",
                        "jsonpath_queries": [
                          {
                            "jsonpath_query": "$.id",
                            "jsonpath_query_name": "incident_id",
                            "jsonpath_query_type": "string"
                          }
                        ],
                        "skip_execution": false
                      },
                      "object_type": "definition_activity"
                    },
                    {
                      "unique_name": "definition_activity_01VGKKRRAOJOT4Llc1oNPCw93vu2RPI3h8G",
                      "name": "Split String",
                      "title": "Split new incident ID",
                      "type": "core.splitstring",
                      "base_type": "activity",
                      "properties": {
                        "boundaries": [
                          {
                            "boundary": "/"
                          }
                        ],
                        "continue_on_failure": false,
                        "display_name": "Split new incident ID",
                        "input_string": "$activity.definition_activity_01VGKKNLW4ALO4diyZXbIlGJR8FohbGAW84.output.jsonpath_queries.incident_id$",
                        "skip_execution": false
                      },
                      "object_type": "definition_activity"
                    },
                    {
                      "unique_name": "definition_activity_01VD5PZ0T9F3H1sRMCrzLeecZjildstutIS",
                      "name": "Threat Response - Create Relationship",
                      "title": "Threat Response - Create Relationship",
                      "type": "workflow.atomic_workflow",
                      "base_type": "subworkflow",
                      "properties": {
                        "continue_on_failure": false,
                        "display_name": "Threat Response - Create Relationship",
                        "input": {
                          "variable_workflow_01PP78LVV8JKR6NKKuym8RA2VYFgUJrR4qU": "$workflow.definition_workflow_01VD4MM2MXRP737N3XKcTIiAispvnk5Ixn9.local.variable_workflow_01VIH3TI6L0EI0rdin3W6UvgMeYdgeaAROK$",
                          "variable_workflow_01PP78LVV8NS94TRyx07G3ajwZ5eE5oWZ36": "",
                          "variable_workflow_01PP78LVV8P3X5wkMhrcIXTnToxb6HxuLpk": "$activity.definition_activity_01VD54Q5RCMVM1OqifPsp2rDm8IrFJqx2mW.output.variable_workflow_01KJXN351DZFM10HhZDCLEZwbRsHOXf3iw4$",
                          "variable_workflow_01PP78LVV8QB314gJIqe5PQHoWnRTMtwhK4": "amber",
                          "variable_workflow_01PP78LVV8RLZ02Yzy68Uz59X8kInnUomdU": "",
                          "variable_workflow_01PP78LVV8SVF31gxGXEVhu26vewW98cJxO": "$activity.definition_activity_01VGKKNLW4ALO4diyZXbIlGJR8FohbGAW84.output.jsonpath_queries.incident_id$",
                          "variable_workflow_01PP78LVV8V4B28e1wJKo9WReVhIZ3bvM6f": "member-of"
                        },
                        "runtime_user": {
                          "target_default": true
                        },
                        "skip_execution": false,
                        "target": {
                          "override_workflow_target": true,
                          "target_id": "definition_target_01FY04GSF89R66tMTam54wFWPLFn81QFsbL",
                          "target_type": "web-service.endpoint"
                        },
                        "workflow_id": "definition_workflow_01PP78LW2WNY80aDM6OHNiRu2VPG4BrR8bq"
                      },
                      "object_type": "definition_activity"
                    },
                    {
                      "unique_name": "definition_activity_01VGNEX07TFCI4yDVGY2oXelzVuFyzrpitk",
                      "name": "Condition Block",
                      "title": "PRIOR CLOSED INCIDENT?",
                      "type": "logic.if_else",
                      "base_type": "activity",
                      "properties": {
                        "continue_on_failure": false,
                        "display_name": "PRIOR CLOSED INCIDENT?",
                        "skip_execution": false
                      },
                      "object_type": "definition_activity",
                      "blocks": [
                        {
                          "unique_name": "definition_activity_01VGNEX0MU6KM0rlrlnhKNB9pd5NYbHcVqt",
                          "name": "Condition Branch",
                          "title": "YES, RELATING INCIDENTS",
                          "type": "logic.condition_block",
                          "base_type": "activity",
                          "properties": {
                            "condition": {
                              "left_operand": {
                                "left_operand": "$workflow.definition_workflow_01VD4MM2MXRP737N3XKcTIiAispvnk5Ixn9.local.variable_workflow_01VGO2YO0W2LF4V1Q8GGoPHk0962BEaP6ZM$",
                                "operator": "eq",
                                "right_operand": "Closed"
                              },
                              "operator": "and",
                              "right_operand": {
                                "left_operand": "$activity.definition_activity_01VDFJWTYS89F5RPSAePsWDPoi5zun4ds6K.output.response_body$",
                                "operator": "ne",
                                "right_operand": "[]"
                              }
                            },
                            "continue_on_failure": false,
                            "display_name": "YES, RELATING INCIDENTS",
                            "skip_execution": false
                          },
                          "object_type": "definition_activity",
                          "actions": [
                            {
                              "unique_name": "definition_activity_01VGNEPFX5IWC7S8n86djvcNPHTiQsHtlfE",
                              "name": "Threat Response - Create Relationship",
                              "title": "Threat Response - Create Relationship",
                              "type": "workflow.atomic_workflow",
                              "base_type": "subworkflow",
                              "properties": {
                                "continue_on_failure": false,
                                "display_name": "Threat Response - Create Relationship",
                                "input": {
                                  "variable_workflow_01PP78LVV8JKR6NKKuym8RA2VYFgUJrR4qU": "$workflow.definition_workflow_01VD4MM2MXRP737N3XKcTIiAispvnk5Ixn9.local.variable_workflow_01VD8NMC1QOBW72m7FZTKKpCNKBbhstcPLm$",
                                  "variable_workflow_01PP78LVV8NS94TRyx07G3ajwZ5eE5oWZ36": "",
                                  "variable_workflow_01PP78LVV8P3X5wkMhrcIXTnToxb6HxuLpk": "$activity.definition_activity_01VD54Q5RCMVM1OqifPsp2rDm8IrFJqx2mW.output.variable_workflow_01KJXN351DZFM10HhZDCLEZwbRsHOXf3iw4$",
                                  "variable_workflow_01PP78LVV8QB314gJIqe5PQHoWnRTMtwhK4": "amber",
                                  "variable_workflow_01PP78LVV8RLZ02Yzy68Uz59X8kInnUomdU": "",
                                  "variable_workflow_01PP78LVV8SVF31gxGXEVhu26vewW98cJxO": "$activity.definition_activity_01VGKKNLW4ALO4diyZXbIlGJR8FohbGAW84.output.jsonpath_queries.incident_id$",
                                  "variable_workflow_01PP78LVV8V4B28e1wJKo9WReVhIZ3bvM6f": "related-to"
                                },
                                "runtime_user": {
                                  "target_default": true
                                },
                                "skip_execution": false,
                                "target": {
                                  "override_workflow_target": true,
                                  "target_id": "definition_target_01FY04GSF89R66tMTam54wFWPLFn81QFsbL",
                                  "target_type": "web-service.endpoint"
                                },
                                "workflow_id": "definition_workflow_01PP78LW2WNY80aDM6OHNiRu2VPG4BrR8bq"
                              },
                              "object_type": "definition_activity"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "unique_name": "definition_activity_01VF29CQLE1500rOc0oLP3sinXX9CxYMlm1",
                      "name": "Webex Teams - Post Message to Room",
                      "title": "Webex Teams - Post Message to Room",
                      "type": "workflow.atomic_workflow",
                      "base_type": "subworkflow",
                      "properties": {
                        "continue_on_failure": false,
                        "display_name": "Webex Teams - Post Message to Room",
                        "input": {
                          "variable_workflow_01PP78DJH1TI76BYfsu9g0Tqj2S6cUxjtu5": "Y2lzY29zcGFyazovL3VzL1JPT00vYzE3NjE4MzAtMDdkNi0xMWViLWE5ZTctYjcxMTViN2U4ZDc0",
                          "variable_workflow_01PP78DJH1XNQ7gNQ5iZdperRHqrppzARXC": "$workflow.definition_workflow_01VD4MM2MXRP737N3XKcTIiAispvnk5Ixn9.local.variable_workflow_01VF27Y5PS5P041xwV8hBeKejbNIzMkh0RB$",
                          "variable_workflow_01PP78DJH1YWL3allalGQbg1VkgKwh9GvCi": "## New correlated incident for target: `$workflow.definition_workflow_01VD4MM2MXRP737N3XKcTIiAispvnk5Ixn9.input.variable_workflow_01VD4YZI81I7P1b9txHYeMm527CBF59shW7$`\\n\\n * Current number of Security Events: `1`\\n\\n * Event observed by: **$workflow.definition_workflow_01VD4MM2MXRP737N3XKcTIiAispvnk5Ixn9.input.variable_workflow_01VHEQPFXLIP95GrisWs7xrgxD9Fci4C35z$**\\n\\n * Indicator observed: **$workflow.definition_workflow_01VD4MM2MXRP737N3XKcTIiAispvnk5Ixn9.input.variable_workflow_01VD4NHUD14JV2TlKlLwn8HdCHzXz0TrfNB$**\\n\\n * Review details here: **https://visibility.amp.cisco.com/incidents?q=id:$activity.definition_activity_01VGKKRRAOJOT4Llc1oNPCw93vu2RPI3h8G.output.parts[-1]$#summary**",
                          "variable_workflow_01PP78DJH22BB3Ej3I8tJ4OCQur0unYGjj9": "",
                          "variable_workflow_01SVERQNMKN8N6vqX2djMtAfshphGydGsH8": ""
                        },
                        "runtime_user": {
                          "target_default": true
                        },
                        "skip_execution": false,
                        "target": {
                          "override_workflow_target": true,
                          "target_id": "definition_target_01G9UGF18RL9E08ziyLuERwNvdLp5Y7JqZ1",
                          "target_type": "web-service.endpoint"
                        },
                        "workflow_id": "definition_workflow_01PP78DJMXS415nTjonujf03ROkr6t2PNyw"
                      },
                      "object_type": "definition_activity"
                    },
                    {
                      "unique_name": "definition_activity_01VYGO2ZSNNGW7C1m0jyVvqF6nulJm0rvRx",
                      "name": "Group",
                      "title": "POTENTIAL OTHER RESPONSE ACTIONS",
                      "type": "logic.group",
                      "base_type": "activity",
                      "properties": {
                        "continue_on_failure": false,
                        "display_name": "POTENTIAL OTHER RESPONSE ACTIONS",
                        "skip_execution": false
                      },
                      "object_type": "definition_activity"
                    }
                  ]
                },
                {
                  "unique_name": "definition_activity_01VD5I6ZEDEEC49bG6Dxm3oPn4kUwoHUPup",
                  "name": "Condition Branch",
                  "title": "PRIOR NON CLOSED INCIDENTS RETURNED",
                  "type": "logic.condition_block",
                  "base_type": "activity",
                  "properties": {
                    "condition": {
                      "left_operand": "$activity.definition_activity_01VDFJWTYS89F5RPSAePsWDPoi5zun4ds6K.output.response_body$",
                      "operator": "ne",
                      "right_operand": "[]"
                    },
                    "continue_on_failure": false,
                    "display_name": "PRIOR NON CLOSED INCIDENTS RETURNED",
                    "skip_execution": false
                  },
                  "object_type": "definition_activity",
                  "actions": [
                    {
                      "unique_name": "definition_activity_01VDGJWVUXRDH3UFejuJZ4x2qwlTD38Z5JL",
                      "name": "Group",
                      "title": "Threat Response - Update Incident",
                      "type": "logic.group",
                      "base_type": "activity",
                      "properties": {
                        "continue_on_failure": false,
                        "display_name": "Threat Response - Update Incident",
                        "skip_execution": false
                      },
                      "object_type": "definition_activity",
                      "actions": [
                        {
                          "unique_name": "definition_activity_01VDGJWVV1BL55Xr2rif2T9XFvx1Xt7pUBz",
                          "name": "Execute Python Script",
                          "title": "Create updated incident JSON",
                          "type": "python3.script",
                          "base_type": "activity",
                          "properties": {
                            "action_timeout": 180,
                            "continue_on_failure": false,
                            "display_name": "Create updated incident JSON",
                            "script": "import json, sys\nfrom datetime import datetime, date, timedelta\n\n# Get the current date/time\ndate_time = datetime.now()\ndate_formatted = date_time.strftime(\"%Y-%m-%dT%H:%M:%SZ\")\ntarget_value = sys.argv[1]\ntarget_type = sys.argv[2]\nioc_value = sys.argv[3]\nioc_type = sys.argv[4]\nold_incident_description = sys.argv[5].encode('utf-8').decode('unicode_escape')\nincident_status = sys.argv[6]\n\n# update event count\nevent_count_str = \"\"\nevent_count_int = 1\nfirst_quote_reached = False\nfor character in old_incident_description:\n  if character == \"`\" and first_quote_reached == False:\n    first_quote_reached = True \n  elif first_quote_reached == True and character != \"`\":\n    event_count_str = event_count_str + character\n  elif first_quote_reached == True and character == \"`\":\n    event_count_int = int(event_count_str) + 1\n    break\n\nupdated_incident_description = old_incident_description.replace(\"`\"+event_count_str+\"`\",\"`\"+str(event_count_int)+\"`\")\n\n# update description\nnew_security_event_description = f\"\\n\\n* On **{date_formatted}**, target **{target_value}** had another security event due to IoC **{ioc_value}** of type [{ioc_type}].\"\nnew_incident_description = updated_incident_description + new_security_event_description\n\n# Build the incident objects\nincident_object = {}\nincident_object[\"description\"] = new_incident_description\nincident_object[\"confidence\"] = \"High\"\n\nincident_json = json.dumps(incident_object)",
                            "script_arguments": [
                              "$workflow.definition_workflow_01VD4MM2MXRP737N3XKcTIiAispvnk5Ixn9.input.variable_workflow_01VD4YZI81I7P1b9txHYeMm527CBF59shW7$",
                              "$workflow.definition_workflow_01VD4MM2MXRP737N3XKcTIiAispvnk5Ixn9.input.variable_workflow_01VD4YRYRMW8532zhQaoOfY629Qj5vTpuSa$",
                              "$workflow.definition_workflow_01VD4MM2MXRP737N3XKcTIiAispvnk5Ixn9.input.variable_workflow_01VD4NHUD14JV2TlKlLwn8HdCHzXz0TrfNB$",
                              "$workflow.definition_workflow_01VD4MM2MXRP737N3XKcTIiAispvnk5Ixn9.input.variable_workflow_01VD4NPNSCW0F6vvq97gA5KO7lXvpIl2ND5$",
                              "$workflow.definition_workflow_01VD4MM2MXRP737N3XKcTIiAispvnk5Ixn9.local.variable_workflow_01VGO29U0AJYZ1sXnEQFwAeZFUcQnxXE13R$",
                              "$workflow.definition_workflow_01VD4MM2MXRP737N3XKcTIiAispvnk5Ixn9.local.variable_workflow_01VGO2U1HN7EM4GgG59D5iHG6rpYtA8H8JD$"
                            ],
                            "script_queries": [
                              {
                                "script_query": "incident_json",
                                "script_query_name": "incident_json",
                                "script_query_type": "string"
                              },
                              {
                                "script_query": "event_count_int",
                                "script_query_name": "event_count_int",
                                "script_query_type": "integer"
                              }
                            ],
                            "skip_execution": false
                          },
                          "object_type": "definition_activity"
                        },
                        {
                          "unique_name": "definition_activity_01VDGJWVV51X836rBZWw9NfEzWQKJsB07l3",
                          "name": "HTTP Request",
                          "title": "Update Incident by ID",
                          "type": "web-service.http_request",
                          "base_type": "activity",
                          "properties": {
                            "accept": "application/json",
                            "action_timeout": 180,
                            "allow_auto_redirect": true,
                            "body": "$activity.definition_activity_01VDGJWVV1BL55Xr2rif2T9XFvx1Xt7pUBz.output.script_queries.incident_json$",
                            "content_type": "application/json",
                            "continue_on_error_status_code": false,
                            "continue_on_failure": true,
                            "custom_headers": [
                              {
                                "name": "Authorization",
                                "value": "Bearer $activity.definition_activity_01VD54Q5RCMVM1OqifPsp2rDm8IrFJqx2mW.output.variable_workflow_01KJXN351DZFM10HhZDCLEZwbRsHOXf3iw4$"
                              }
                            ],
                            "display_name": "Update Incident by ID",
                            "method": "PATCH",
                            "relative_url": "/ctia/incident/$workflow.definition_workflow_01VD4MM2MXRP737N3XKcTIiAispvnk5Ixn9.local.variable_workflow_01VGO0H7UA5A75yQGvRaJdhyriWUnEs7VD9$",
                            "runtime_user": {
                              "target_default": true
                            },
                            "skip_execution": false,
                            "target": {
                              "override_workflow_target": true,
                              "target_id": "definition_target_01FY04GSF89R66tMTam54wFWPLFn81QFsbL"
                            }
                          },
                          "object_type": "definition_activity"
                        },
                        {
                          "unique_name": "definition_activity_01VDGJWVV5ZUC6DCfpPfXNSMJgC0gtuOj9p",
                          "name": "Condition Block",
                          "title": "ERROR CHECKING",
                          "type": "logic.if_else",
                          "base_type": "activity",
                          "properties": {
                            "continue_on_failure": false,
                            "display_name": "ERROR CHECKING",
                            "skip_execution": false
                          },
                          "object_type": "definition_activity",
                          "blocks": [
                            {
                              "unique_name": "definition_activity_01VDGJWVV7Y593jSvsyqIWN6vfMbiA7EMpm",
                              "name": "Condition Branch",
                              "title": "not 200",
                              "type": "logic.condition_block",
                              "base_type": "activity",
                              "properties": {
                                "condition": {
                                  "left_operand": "$activity.definition_activity_01VDGJWVV51X836rBZWw9NfEzWQKJsB07l3.output.status_code$",
                                  "operator": "ne",
                                  "right_operand": 200
                                },
                                "continue_on_failure": false,
                                "display_name": "not 200",
                                "skip_execution": false
                              },
                              "object_type": "definition_activity",
                              "actions": [
                                {
                                  "unique_name": "definition_activity_01VDGJWVVAIBL4lXqZ5dTAobHZIWStDGibw",
                                  "name": "Completed",
                                  "title": "Failed",
                                  "type": "logic.completed",
                                  "base_type": "activity",
                                  "properties": {
                                    "completion_type": "failed-completed",
                                    "continue_on_failure": false,
                                    "display_name": "Failed",
                                    "result_message": "Failed",
                                    "skip_execution": false
                                  },
                                  "object_type": "definition_activity"
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "unique_name": "definition_activity_01VDB0JXDQUBQ4vFIE1omZuggAVs8XYaSYQ",
                      "name": "Threat Response - Create Relationship",
                      "title": "Threat Response - Create Relationship",
                      "type": "workflow.atomic_workflow",
                      "base_type": "subworkflow",
                      "properties": {
                        "continue_on_failure": false,
                        "display_name": "Threat Response - Create Relationship",
                        "input": {
                          "variable_workflow_01PP78LVV8JKR6NKKuym8RA2VYFgUJrR4qU": "$workflow.definition_workflow_01VD4MM2MXRP737N3XKcTIiAispvnk5Ixn9.local.variable_workflow_01VIH3TI6L0EI0rdin3W6UvgMeYdgeaAROK$",
                          "variable_workflow_01PP78LVV8NS94TRyx07G3ajwZ5eE5oWZ36": "",
                          "variable_workflow_01PP78LVV8P3X5wkMhrcIXTnToxb6HxuLpk": "$activity.definition_activity_01VD54Q5RCMVM1OqifPsp2rDm8IrFJqx2mW.output.variable_workflow_01KJXN351DZFM10HhZDCLEZwbRsHOXf3iw4$",
                          "variable_workflow_01PP78LVV8QB314gJIqe5PQHoWnRTMtwhK4": "amber",
                          "variable_workflow_01PP78LVV8RLZ02Yzy68Uz59X8kInnUomdU": "",
                          "variable_workflow_01PP78LVV8SVF31gxGXEVhu26vewW98cJxO": "$workflow.definition_workflow_01VD4MM2MXRP737N3XKcTIiAispvnk5Ixn9.local.variable_workflow_01VD8NMC1QOBW72m7FZTKKpCNKBbhstcPLm$",
                          "variable_workflow_01PP78LVV8V4B28e1wJKo9WReVhIZ3bvM6f": "member-of"
                        },
                        "runtime_user": {
                          "target_default": true
                        },
                        "skip_execution": false,
                        "target": {
                          "override_workflow_target": true,
                          "target_id": "definition_target_01FY04GSF89R66tMTam54wFWPLFn81QFsbL",
                          "target_type": "web-service.endpoint"
                        },
                        "workflow_id": "definition_workflow_01PP78LW2WNY80aDM6OHNiRu2VPG4BrR8bq"
                      },
                      "object_type": "definition_activity"
                    },
                    {
                      "unique_name": "definition_activity_01VF25MDOY5V03a7aXd3O5c8rbbagyZJH45",
                      "name": "Webex Teams - Post Message to Room",
                      "title": "Webex Teams - Post Message to Room",
                      "type": "workflow.atomic_workflow",
                      "base_type": "subworkflow",
                      "properties": {
                        "continue_on_failure": false,
                        "display_name": "Webex Teams - Post Message to Room",
                        "input": {
                          "variable_workflow_01PP78DJH1TI76BYfsu9g0Tqj2S6cUxjtu5": "Y2lzY29zcGFyazovL3VzL1JPT00vYzE3NjE4MzAtMDdkNi0xMWViLWE5ZTctYjcxMTViN2U4ZDc0",
                          "variable_workflow_01PP78DJH1XNQ7gNQ5iZdperRHqrppzARXC": "$workflow.definition_workflow_01VD4MM2MXRP737N3XKcTIiAispvnk5Ixn9.local.variable_workflow_01VF27Y5PS5P041xwV8hBeKejbNIzMkh0RB$",
                          "variable_workflow_01PP78DJH1YWL3allalGQbg1VkgKwh9GvCi": "## Incident updated for target: `$workflow.definition_workflow_01VD4MM2MXRP737N3XKcTIiAispvnk5Ixn9.input.variable_workflow_01VD4YZI81I7P1b9txHYeMm527CBF59shW7$`\\n\\n * Current number of Security Events: `$activity.definition_activity_01VDGJWVV1BL55Xr2rif2T9XFvx1Xt7pUBz.output.script_queries.event_count_int$`\\n\\n * Event detected by: **$workflow.definition_workflow_01VD4MM2MXRP737N3XKcTIiAispvnk5Ixn9.input.variable_workflow_01VHEQPFXLIP95GrisWs7xrgxD9Fci4C35z$**\\n\\n * Indicator of Compromise observed: **$workflow.definition_workflow_01VD4MM2MXRP737N3XKcTIiAispvnk5Ixn9.input.variable_workflow_01VD4NHUD14JV2TlKlLwn8HdCHzXz0TrfNB$**\\n\\n * Review details here: **https://visibility.amp.cisco.com/incidents?q=id:$workflow.definition_workflow_01VD4MM2MXRP737N3XKcTIiAispvnk5Ixn9.local.variable_workflow_01VGO0H7UA5A75yQGvRaJdhyriWUnEs7VD9$#summary**",
                          "variable_workflow_01PP78DJH22BB3Ej3I8tJ4OCQur0unYGjj9": "",
                          "variable_workflow_01SVERQNMKN8N6vqX2djMtAfshphGydGsH8": ""
                        },
                        "runtime_user": {
                          "target_default": true
                        },
                        "skip_execution": false,
                        "target": {
                          "override_workflow_target": true,
                          "target_id": "definition_target_01G9UGF18RL9E08ziyLuERwNvdLp5Y7JqZ1",
                          "target_type": "web-service.endpoint"
                        },
                        "workflow_id": "definition_workflow_01PP78DJMXS415nTjonujf03ROkr6t2PNyw"
                      },
                      "object_type": "definition_activity"
                    },
                    {
                      "unique_name": "definition_activity_01VYGO6LWDF29481flEEYfQKPi3sxhBMeGQ",
                      "name": "Group",
                      "title": "POTENTIAL OTHER RESPONSE ACTIONS",
                      "type": "logic.group",
                      "base_type": "activity",
                      "properties": {
                        "continue_on_failure": false,
                        "display_name": "POTENTIAL OTHER RESPONSE ACTIONS",
                        "skip_execution": false
                      },
                      "object_type": "definition_activity",
                      "actions": [
                        {
                          "unique_name": "definition_activity_01VYHB4ZD0SS22w6TFgvyW3oeFFF28svc6B",
                          "name": "Condition Block",
                          "title": "how many sightings in incident?",
                          "type": "logic.if_else",
                          "base_type": "activity",
                          "properties": {
                            "continue_on_failure": false,
                            "display_name": "how many sightings in incident?",
                            "skip_execution": false
                          },
                          "object_type": "definition_activity",
                          "blocks": [
                            {
                              "unique_name": "definition_activity_01VYHB4ZTPC4M7X3HDGhRGqSyrw76beRNA4",
                              "name": "Condition Branch",
                              "title": "5 sightings or more",
                              "type": "logic.condition_block",
                              "base_type": "activity",
                              "properties": {
                                "condition": {
                                  "left_operand": "$activity.definition_activity_01VDGJWVV1BL55Xr2rif2T9XFvx1Xt7pUBz.output.script_queries.event_count_int$",
                                  "operator": "gte",
                                  "right_operand": 5
                                },
                                "continue_on_failure": false,
                                "display_name": "5 sightings or more",
                                "skip_execution": false
                              },
                              "object_type": "definition_activity"
                            },
                            {
                              "unique_name": "definition_activity_01VYHE1VL8K087OGMogYhWPvids46HQaXNK",
                              "name": "Condition Branch",
                              "title": "3 sightings or more",
                              "type": "logic.condition_block",
                              "base_type": "activity",
                              "properties": {
                                "condition": {
                                  "left_operand": "$activity.definition_activity_01VDGJWVV1BL55Xr2rif2T9XFvx1Xt7pUBz.output.script_queries.event_count_int$",
                                  "operator": "gte",
                                  "right_operand": 3
                                },
                                "continue_on_failure": false,
                                "display_name": "3 sightings or more",
                                "skip_execution": false
                              },
                              "object_type": "definition_activity"
                            },
                            {
                              "unique_name": "definition_activity_01VYHB5096P2P6j3JtDhUexWqND8TzYGD9U",
                              "name": "Condition Branch",
                              "title": "2 sightings",
                              "type": "logic.condition_block",
                              "base_type": "activity",
                              "properties": {
                                "condition": {
                                  "left_operand": "$activity.definition_activity_01VDGJWVV1BL55Xr2rif2T9XFvx1Xt7pUBz.output.script_queries.event_count_int$",
                                  "operator": "eq",
                                  "right_operand": 2
                                },
                                "continue_on_failure": false,
                                "display_name": "2 sightings",
                                "skip_execution": false
                              },
                              "object_type": "definition_activity"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ],
          "categories": [
            "category_1BMfMXSnJMyt5Ihqi7rWJr5N8cf"
          ]
        }
      }
    ],
    "atomic_workflows": [
      "definition_workflow_01PP75S3LTBW4420OZU3rdHWKHFnE6aC7yH",
      "definition_workflow_01PP78LW2WNY80aDM6OHNiRu2VPG4BrR8bq",
      "definition_workflow_01KJXN35DBN5444diA78eCQ0YxYn8a7MMu6",
      "definition_workflow_01PP78DJMXS415nTjonujf03ROkr6t2PNyw",
      "definition_workflow_01PP77MLQ4QAG765OwlT0ZDqBzv80HvYuPC",
      "definition_workflow_01PP78TYLE76D6188QkWvzWydNU6L8PtlvS",
      "definition_workflow_01PP7586MYQ913P0nWshTHMU7mQNNFG58Bv"
    ]
  }